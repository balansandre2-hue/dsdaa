<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T.M. // MARKETPLACE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        const origWarn = console.warn;
        console.warn = (...args) => {
            if (args[0] && typeof args[0] === 'string' && args[0].includes('cdn.tailwindcss.com')) return;
            origWarn.apply(console, args);
        };
        
        tailwind.config = {
            theme: {
                extend: {
                    colors: { 
                        bg: '#111111',
                        surface: '#1c1c1c',
                        border: '#333333',
                        text: '#e5e5e5',
                        accent: '#3b82f6',
                        success: '#22c55e'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        body { background-color: #111111; color: #e5e5e5; font-family: 'Inter', sans-serif; font-size: 14px; line-height: 1.5; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #111; }
        ::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

        .btn { 
            background: #252525; border: 1px solid #444; color: #ccc; 
            padding: 8px 16px; font-weight: 600; font-size: 12px; 
            text-transform: uppercase; letter-spacing: 0.5px; transition: all 0.2s; 
        }
        .btn:hover { background: #333; color: #fff; border-color: #666; }
        .btn:active { transform: translateY(1px); }
        
        .btn-primary { background: #1e3a8a; border-color: #2563eb; color: #fff; }
        .btn-primary:hover { background: #1d4ed8; border-color: #3b82f6; }

        .panel { background: #1c1c1c; border: 1px solid #333; border-radius: 4px; }
        
        input, select { 
            background: #111; border: 1px solid #444; color: #fff; 
            padding: 8px; font-size: 13px; width: 100%; outline: none; transition: border-color 0.2s;
        }
        input:focus, select:focus { border-color: #3b82f6; }

        .modal-overlay { background: rgba(0, 0, 0, 0.9); backdrop-filter: blur(4px); }
        .modal { transition: opacity 0.2s ease; }
        
        .forum-post { background: #151515; padding: 10px; border-left: 3px solid #333; margin-bottom: 8px; }
        .forum-header { font-size: 11px; color: #888; margin-bottom: 4px; font-weight: 600; }
        
        .trust-badge { background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); color: #4ade80; }
        .info-block { border-left: 4px solid #3b82f6; background: #161616; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="bg-surface border-b border-border sticky top-0 z-40 shadow-md">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-between h-16">
                <!-- –õ–æ–≥–æ—Ç–∏–ø -->
                <div class="flex items-center gap-3 cursor-pointer select-none" onclick="renderProducts('all')">
                    <div class="w-8 h-8 bg-blue-900 flex items-center justify-center border border-blue-700 font-bold text-blue-400 text-xs">TS</div>
                    <div class="flex flex-col">
                        <span class="font-bold text-base tracking-wide text-white leading-none">TACTICAL</span>
                        <span class="text-[10px] text-gray-500 font-medium tracking-widest">MARKETPLACE</span>
                    </div>
                </div>
                
                <!-- –ú–µ–Ω—é -->
                <div class="hidden md:flex space-x-2">
                    <button onclick="renderProducts('all')" class="btn hover:bg-[#2a2a2a]">–í—Å–µ –ª–æ—Ç—ã</button>
                    <button onclick="renderProducts('combat')" class="btn hover:bg-[#2a2a2a]">–ë–æ–µ–≤–æ–µ</button>
                    <button onclick="renderProducts('traumatic')" class="btn hover:bg-[#2a2a2a]">–¢—Ä–∞–≤–º–∞—Ç–∏—á–µ—Å–∫–æ–µ</button>
                    <button onclick="renderProducts('other')" class="btn hover:bg-[#2a2a2a]">–°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ</button>
                </div>

                <!-- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã -->
                <div class="flex items-center gap-4">
                    <div class="relative hidden sm:block">
                        <input type="text" id="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É..." class="w-56 bg-[#111] border border-[#444] rounded-sm py-1.5 px-3 text-sm focus:border-blue-500">
                    </div>
                    
                    <button onclick="openCart()" class="btn flex items-center gap-2 px-3 py-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                        <span id="cart-count" class="text-white hidden">0</span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
        <div class="md:hidden grid grid-cols-4 border-t border-border bg-[#111] text-[10px]">
            <button onclick="renderProducts('all')" class="p-3 border-r border-border hover:bg-surface text-gray-400 font-bold">–í–°–ï</button>
            <button onclick="renderProducts('combat')" class="p-3 border-r border-border hover:bg-surface text-gray-400 font-bold">–ë–û–ï–í–û–ï</button>
            <button onclick="renderProducts('traumatic')" class="p-3 border-r border-border hover:bg-surface text-gray-400 font-bold">–¢–†–ê–í–ú–ê–¢</button>
            <button onclick="renderProducts('other')" class="p-3 hover:bg-surface text-gray-400 font-bold">–ó–ò–ü</button>
        </div>
    </nav>

    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="flex-grow max-w-7xl mx-auto px-4 py-8 w-full">
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–ª–∞—à–∫–∞ -->
        <div class="mb-8 info-block p-5 rounded-sm shadow-lg">
            <h2 class="text-lg font-bold text-white mb-2 uppercase tracking-wide flex items-center gap-2">
                <span class="text-blue-500">üõ°Ô∏è</span> –ì–∞—Ä–∞–Ω—Ç–∏—è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            </h2>
            <p class="text-sm text-gray-400 leading-relaxed font-medium">
                –ú—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—É—é –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞. –†–∞–±–æ—Ç–∞–µ–º –Ω–∞ —Å–æ–≤–µ—Å—Ç—å —É–∂–µ –º–Ω–æ–≥–æ –ª–µ—Ç, –∏–º–µ–µ–º –±–µ–∑—É–ø—Ä–µ—á–Ω—É—é —Ä–µ–ø—É—Ç–∞—Ü–∏—é –≤ —Ç–µ–Ω–µ–≤–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ. –í—Å–µ —Å–¥–µ–ª–∫–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã —Å–≤—è–∑–∏, –ª–æ–≥–∏ —É–¥–∞–ª—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ. –í–∞—à–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Äî –Ω–∞—à –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç.
            </p>
            <div class="mt-4 flex items-center gap-4 text-xs font-mono text-gray-500 border-t border-[#333] pt-3">
                <span>STATUS: <span class="text-green-500">SECURE</span></span>
                <span>ENCRYPTION: <span class="text-blue-500">PGP/AES</span></span>
                <span>UPTIME: <span class="text-gray-300">99.9%</span></span>
            </div>
        </div>

        <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5"></div>
        
        <div id="empty-state" class="hidden flex flex-col items-center justify-center py-24 text-gray-600">
            <span class="text-4xl mb-2 grayscale opacity-50">üìÇ</span>
            <span class="font-mono text-sm">–õ–û–¢–´ –ù–ï –ù–ê–ô–î–ï–ù–´</span>
            <button onclick="handleSearch('')" class="mt-4 text-blue-500 hover:text-blue-400 text-xs underline">–°–ë–†–û–°–ò–¢–¨ –§–ò–õ–¨–¢–†–´</button>
        </div>
    </main>

    <!-- –§—É—Ç–µ—Ä -->
    <footer class="border-t border-border bg-surface py-8 mt-auto">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4 text-xs text-gray-500">
                <p>&copy; 2026 TACTICAL MARKET. –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å.</p>
                <div class="flex flex-wrap justify-center gap-6 font-medium">
                    <button onclick="openTextModal('garant')" class="hover:text-white transition uppercase">–ì–∞—Ä–∞–Ω—Ç</button>
                    <button onclick="openTextModal('rules')" class="hover:text-white transition uppercase">–ü—Ä–∞–≤–∏–ª–∞</button>
                    <a href="https://t.me/+l4Mt8VCqCf42ZDU5" target="_blank" class="hover:text-blue-400 transition uppercase">–û—Ç–∑—ã–≤—ã –ö–ª–∏–µ–Ω—Ç–æ–≤</a>
                    <a href="https://wa.me/79308450299" target="_blank" class="hover:text-green-500 transition uppercase flex items-center gap-1">
                        <span>WhatsApp: +7 930 845 0299</span>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –ü—Ä–æ—Å–º–æ—Ç—Ä -->
    <div id="product-modal" class="modal hidden fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0" onclick="closeProductModal()"></div>
        <div class="relative bg-[#1c1c1c] w-full max-w-3xl border border-[#333] shadow-2xl flex flex-col max-h-[90vh] rounded-sm">
            
            <div class="flex justify-between items-center px-5 py-3 border-b border-[#333] bg-[#181818]">
                <h3 class="font-bold text-gray-300 text-sm tracking-wide">–ö–ê–†–¢–û–ß–ö–ê –¢–û–í–ê–†–ê</h3>
                <button onclick="closeProductModal()" class="text-gray-500 hover:text-white text-lg font-mono">[x]</button>
            </div>

            <div class="overflow-y-auto p-6 custom-scrollbar bg-[#111]">
                <div class="flex flex-col md:flex-row gap-8 mb-8">
                    <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
                    <div class="w-full md:w-64 h-64 bg-[#0a0a0a] border border-[#333] flex items-center justify-center text-7xl flex-shrink-0 rounded-sm relative overflow-hidden">
                        <span id="pm-icon" class="relative z-10 drop-shadow-2xl"></span>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                    </div>
                    
                    <div class="flex-grow flex flex-col">
                        <div class="flex justify-between items-start mb-2">
                            <h2 id="pm-name" class="text-2xl font-bold text-white uppercase tracking-tight"></h2>
                            <span id="pm-badge" class="hidden px-2 py-1 bg-blue-900/30 border border-blue-800 text-blue-400 text-[10px] font-bold uppercase rounded-sm"></span>
                        </div>
                        
                        <div class="flex items-center gap-3 mb-6 text-xs border-b border-[#222] pb-4">
                            <div class="flex items-center gap-1 text-yellow-600">
                                <span>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                                <span id="pm-rating" class="text-gray-400 font-mono ml-1"></span>
                            </div>
                            <span class="text-gray-700">|</span>
                            <span class="text-gray-500 font-mono">ID: <span id="pm-id-display"></span></span>
                        </div>

                        <div class="mb-6 text-sm text-gray-300 leading-relaxed whitespace-pre-line font-light" id="pm-desc"></div>

                        <div class="flex items-center justify-between mt-auto bg-[#151515] p-4 border border-[#222] rounded-sm">
                            <div class="flex flex-col">
                                <span class="text-[10px] text-gray-500 uppercase font-bold">–¶–µ–Ω–∞ –ª–æ—Ç–∞</span>
                                <span id="pm-price" class="text-2xl text-white font-bold tracking-tight"></span>
                            </div>
                            <button onclick="addToCartCurrent()" class="btn-primary px-8 py-3 rounded-sm font-bold text-sm shadow-lg shadow-blue-900/20">–í –ö–û–†–ó–ò–ù–£</button>
                        </div>
                    </div>
                </div>
                
                <!-- –û—Ç–∑—ã–≤—ã -->
                <div class="border-t border-[#333] pt-6">
                    <h4 class="text-xs font-bold text-gray-500 mb-4 uppercase tracking-wider">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã –≤ —Å–µ—Ç–∏</h4>
                    <div id="pm-reviews" class="space-y-3"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –ö–æ—Ä–∑–∏–Ω–∞ -->
    <div id="cart-modal" class="modal hidden fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0" onclick="closeCartModal()"></div>
        <div class="relative bg-[#1c1c1c] w-full max-w-lg border border-[#333] shadow-2xl flex flex-col max-h-[90vh] rounded-sm">
            
            <div class="flex justify-between items-center px-5 py-3 border-b border-[#333] bg-[#181818]">
                <h3 id="cart-title" class="font-bold text-gray-300 text-sm tracking-wide">–ö–û–†–ó–ò–ù–ê</h3>
                <button onclick="closeCartModal()" class="text-gray-500 hover:text-white font-mono">[x]</button>
            </div>

            <div class="overflow-y-auto p-5 custom-scrollbar bg-[#111] flex-grow">
                
                <!-- 1. –°–ø–∏—Å–æ–∫ -->
                <div id="view-cart-list">
                    <div id="cart-items" class="space-y-3 mb-6"></div>
                    <div id="cart-empty" class="text-center py-12 border border-dashed border-[#333] rounded-sm">
                        <span class="text-2xl block mb-2 opacity-30">üõí</span>
                        <span class="text-xs text-gray-500 font-mono">–°–ü–ò–°–û–ö –ü–£–°–¢</span>
                    </div>
                    
                    <div id="cart-summary" class="border-t border-[#333] pt-5 mt-4 hidden">
                        <div class="flex justify-between items-center mb-6 text-sm bg-[#151515] p-3 border border-[#222] rounded-sm">
                            <span class="text-gray-400">–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞:</span>
                            <span id="cart-total" class="font-bold text-white text-lg">0 ‚ÇΩ</span>
                        </div>
                        <button onclick="toCheckout()" class="btn-primary w-full py-4 font-bold text-sm rounded-sm">–ü–ï–†–ï–ô–¢–ò –ö –û–§–û–†–ú–õ–ï–ù–ò–Æ</button>
                    </div>
                </div>

                <!-- 2. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ -->
                <div id="view-checkout" class="hidden space-y-5">
                    <div class="text-xs text-gray-500 cursor-pointer hover:text-white mb-2 flex items-center gap-1" onclick="toCartView()">
                        <span>‚Üê</span> –ù–∞–∑–∞–¥
                    </div>

                    <!-- –ì–∞—Ä–∞–Ω—Ç–∏—è -->
                    <div class="trust-badge p-4 rounded-sm flex gap-3 items-start">
                        <span class="text-xl">üõ°Ô∏è</span>
                        <div>
                            <h4 class="font-bold text-xs uppercase mb-1 text-green-400">–ì–∞—Ä–∞–Ω—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h4>
                            <p class="text-[11px] text-gray-400 leading-relaxed">
                                –ú—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—É—é –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å. –†–∞–±–æ—Ç–∞–µ–º –Ω–∞ —Å–æ–≤–µ—Å—Ç—å —É–∂–µ –º–Ω–æ–≥–æ –ª–µ—Ç. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —à–∏—Ñ—Ä—É—é—Ç—Å—è, –ª–æ–≥–∏ —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏.
                            </p>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-[10px] font-bold text-gray-500 mb-1 uppercase">–°—Ç—Ä–∞–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∏</label>
                                <select id="country" class="w-full rounded-sm" onchange="updateCities()">
                                    <option value="ru">–†–æ—Å—Å–∏—è (RF)</option>
                                    <option value="ua">–£–∫—Ä–∞–∏–Ω–∞ (UA)</option>
                                    <option value="kz">–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω (KZ)</option>
                                    <option value="by">–ë–µ–ª–∞—Ä—É—Å—å (BY)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-[10px] font-bold text-gray-500 mb-1 uppercase">–ì–æ—Ä–æ–¥</label>
                                <select id="city" class="w-full rounded-sm"></select>
                            </div>
                        </div>

                        <div>
                            <label class="block text-[10px] font-bold text-gray-500 mb-1 uppercase">Email (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                            <input type="email" id="email" placeholder="–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —á–µ–∫–∞..." class="w-full rounded-sm">
                        </div>

                        <div>
                            <label class="block text-[10px] font-bold text-gray-500 mb-1 uppercase">–ú–µ—Ç–æ–¥ –¥–æ—Å—Ç–∞–≤–∫–∏</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="cursor-pointer">
                                    <input type="radio" name="delivery" value="courier" class="peer sr-only" checked>
                                    <div class="text-center py-3 border border-[#333] bg-[#151515] peer-checked:border-blue-600 peer-checked:bg-blue-900/10 peer-checked:text-blue-400 text-gray-400 text-xs font-bold rounded-sm transition hover:bg-[#222]">
                                        –ö–£–†–¨–ï–†
                                    </div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="delivery" value="drop" class="peer sr-only">
                                    <div class="text-center py-3 border border-[#333] bg-[#151515] peer-checked:border-blue-600 peer-checked:bg-blue-900/10 peer-checked:text-blue-400 text-gray-400 text-xs font-bold rounded-sm transition hover:bg-[#222]">
                                        –¢–ê–ô–ù–ò–ö (–ö–õ–ê–î)
                                    </div>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label class="block text-[10px] font-bold text-gray-500 mb-1 uppercase">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</label>
                            <div class="space-y-2">
                                <label class="flex items-center justify-between p-3 border border-[#333] bg-[#151515] rounded-sm cursor-pointer hover:border-gray-500 transition">
                                    <span class="flex items-center gap-2 text-xs font-bold text-gray-300">USDT (TRC20)</span>
                                    <input type="radio" name="payment" value="usdt" checked class="accent-blue-600">
                                </label>
                                <label class="flex items-center justify-between p-3 border border-[#333] bg-[#151515] rounded-sm cursor-pointer hover:border-gray-500 transition">
                                    <span class="flex items-center gap-2 text-xs font-bold text-gray-300">BITCOIN (BTC)</span>
                                    <input type="radio" name="payment" value="btc" class="accent-blue-600">
                                </label>
                                <label class="flex items-center justify-between p-3 border border-[#333] bg-[#151515] rounded-sm cursor-pointer hover:border-gray-500 transition">
                                    <span class="flex items-center gap-2 text-xs font-bold text-gray-300">LITECOIN (LTC)</span>
                                    <input type="radio" name="payment" value="ltc" class="accent-blue-600">
                                </label>
                            </div>
                        </div>
                    </div>

                    <button onclick="toInvoice()" class="btn-primary w-full py-4 mt-4 font-bold text-sm rounded-sm uppercase tracking-wide">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
                </div>

                <!-- 3. –ò–Ω–≤–æ–π—Å -->
                <div id="view-invoice" class="hidden text-center">
                    <h3 class="text-xs font-bold text-gray-400 mb-2 uppercase border-b border-[#333] pb-2">–°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞: –û–ñ–ò–î–ê–ù–ò–ï</h3>
                    <div id="timer" class="text-3xl text-red-500 font-mono font-bold mb-6 animate-pulse">15:00</div>
                    
                    <div class="bg-[#050505] border border-[#333] p-4 text-left mb-6 font-mono text-xs rounded-sm">
                        <div class="flex justify-between mb-3 border-b border-[#222] pb-2">
                            <span class="text-gray-500">–°—É–º–º–∞ (RUB):</span>
                            <span id="inv-rub" class="text-white font-bold"></span>
                        </div>
                        <div class="flex justify-between mb-4">
                            <span class="text-gray-400">–ö –æ–ø–ª–∞—Ç–µ (CRYPTO):</span>
                            <span id="inv-crypto" class="text-green-400 font-bold"></span>
                        </div>
                        <div class="pt-2">
                            <div class="text-[10px] text-gray-600 mb-1 uppercase font-bold">–ê–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞ (<span id="inv-wallet-name"></span>)</div>
                            <div class="bg-[#111] p-3 border border-[#333] break-all text-white cursor-pointer hover:border-blue-500 transition select-all" id="inv-addr" onclick="copyWallet()"></div>
                            <div class="text-right mt-1"><span class="text-[10px] text-blue-500 cursor-pointer hover:underline uppercase font-bold" onclick="copyWallet()">[–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å]</span></div>
                        </div>
                    </div>
                    
                    <button onclick="showToast('–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏... –û–∂–∏–¥–∞–π—Ç–µ.', 'success'); closeCartModal(); cart=[]; updateCartUI();" class="btn w-full py-3 border border-[#444]">–Ø –û–ü–õ–ê–¢–ò–õ</button>
                </div>

            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–ì–∞—Ä–∞–Ω—Ç/–ü—Ä–∞–≤–∏–ª–∞) -->
    <div id="info-modal" class="modal hidden fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0" onclick="closeInfoModal()"></div>
        <div class="relative bg-[#1c1c1c] w-full max-w-lg border border-[#333] shadow-2xl flex flex-col max-h-[90vh] rounded-sm">
            <div class="flex justify-between items-center px-5 py-3 border-b border-[#333] bg-[#181818]">
                <h3 id="info-title" class="font-bold text-gray-300 text-sm tracking-wide">–ò–ù–§–û–†–ú–ê–¶–ò–Ø</h3>
                <button onclick="closeInfoModal()" class="text-gray-500 hover:text-white font-mono">[x]</button>
            </div>
            <div class="overflow-y-auto p-6 custom-scrollbar bg-[#111]">
                <div id="info-content" class="text-gray-300 text-sm leading-relaxed whitespace-pre-line font-light"></div>
            </div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="toast-container" class="fixed bottom-5 right-5 flex flex-col gap-2 z-50"></div>

    <script>
        const PRODUCTS = [
            { id: "c1", cat: "combat", name: "AK-74M [IZHMASH]", price: 45000, icon: "‚öîÔ∏è", badge: "HIT", rating: "4.9", desc: "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü (–°–•–ü). –î–µ–∞–∫—Ç–∏–≤ –∑–∞–≤–æ–¥—Å–∫–æ–π. –ú–µ—Ö–∞–Ω–∏–∫–∞ –≤ –∏–¥–µ–∞–ª–µ. –î–æ–∫—É–º–µ–Ω—Ç—ã –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ.\n–ö–∞–ª–∏–±—Ä: 5.45x39\n–°–æ—Å—Ç–æ—è–Ω–∏–µ: –°–∫–ª–∞–¥", reviews: [{u:"user_3421",t:"–ü–æ–ª—É—á–∏–ª –∑–∞–∫–ª–∞–¥–∫–æ–π. –í—Å–µ —Ä–æ–≤–Ω–æ. –°–º–∞–∑–∫–∞ –≤ –Ω–æ—Ä–º–µ.",r:5}, {u:"ak_lover",t:"–î–æ—Å—Ç–∞–≤–∫–∞ 3 –¥–Ω—è. –£–ø–∞–∫–æ–≤–∫–∞ - –º–æ–µ –ø–æ—á—Ç–µ–Ω–∏–µ.",r:5}] },
            { id: "c2", cat: "combat", name: "AKS-74U 'KRINKOV'", price: 52000, icon: "üå™", badge: null, rating: "5.0", desc: "–£–∫–æ—Ä–æ—á–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è. –î–µ—Ä–µ–≤–æ —Ä–æ–¥–Ω–æ–µ, –ª–∞–∫. –ù–æ–º–µ—Ä–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç.\n–ö–∞–ª–∏–±—Ä: 5.45x39\n–í–µ—Å: 2.7–∫–≥", reviews: [{u:"driver_msk",t:"–î–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å–∞–º–æ–µ —Ç–æ. –ü—Ä–æ–¥–∞–≤—Ü—É —Ä–µ—Å–ø–µ–∫—Ç.",r:5}] },
            { id: "c3", cat: "combat", name: "AKM [1960s]", price: 48000, icon: "üî•", badge: "RARE", rating: "4.8", desc: "–°–æ–≤–µ—Ç—Å–∫–∞—è –∫–ª–∞—Å—Å–∏–∫–∞. –¢—É–ª—å—Å–∫–∏–π –æ—Ä—É–∂–µ–π–Ω—ã–π. –§—Ä–µ–∑–µ—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ—Ä–æ–±–∫–∞.\n–ö–∞–ª–∏–±—Ä: 7.62x39", reviews: [{u:"collect_01",t:"–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –≤–µ—â—å. –¢—è–∂–µ–ª—ã–π, –Ω–∞–¥–µ–∂–Ω—ã–π.",r:5}] },
            { id: "c4", cat: "combat", name: "SVD [DRAGUNOV]", price: 85000, icon: "üéØ", badge: null, rating: "5.0", desc: "–°–Ω–∞–π–ø–µ—Ä—Å–∫–∞—è –≤–∏–Ω—Ç–æ–≤–∫–∞. –í –∫–æ–º–ø–ª–µ–∫—Ç–µ –ü–°–û-1 (—Å–µ—Ç–∫–∞ —Ü–µ–ª–∞—è). –ß–µ—Ö–æ–ª.\n–ö–∞–ª–∏–±—Ä: 7.62x54R", reviews: [{u:"scope_x",t:"–õ–∏–Ω–∑—ã —á–∏—Å—Ç—ã–µ. –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —á–∞—Å—ã.",r:5}] },
            { id: "c5", cat: "combat", name: "PM [MAKAROV]", price: 25000, icon: "‚≠ê", badge: "TOP", rating: "4.7", desc: "–ü–ú –æ–±—Ä–∞–∑—Ü–∞ 80-—Ö. –ö—Ä–∞—Å–Ω—ã–π –∑–∏–ø. –í–æ—Ä–æ–Ω–µ–Ω–∏–µ –Ω–µ —Å—Ç–µ—Ä—Ç–æ.\n–ö–∞–ª–∏–±—Ä: 9x18", reviews: [{u:"anon_99",t:"–ö–ª–∞—Å—Å–∏–∫–∞ –∂–∞–Ω—Ä–∞. –í –º–∞—Å–ª–µ.",r:4}] },
            { id: "c6", cat: "combat", name: "TT-33 [TOKAREV]", price: 32000, icon: "üî´", badge: null, rating: "4.9", desc: "–í–æ–µ–Ω–Ω—ã–π –≤—ã–ø—É—Å–∫. –ë–µ–∑ —Ä–µ–º–æ–Ω—Ç–Ω—ã—Ö –∫–ª–µ–π–º. –°—Ç–≤–æ–ª –Ω–∞ —à—Ç–∏—Ñ—Ç–∞—Ö.\n–ö–∞–ª–∏–±—Ä: 7.62x25", reviews: [{u:"history_buff",t:"–ú–æ—â–Ω–∞—è –≤–µ—â—å. –ü—Ä–æ–±–∏–≤–∞–µ—Ç –Ω–∞ —É—Ä–∞.",r:5}] },
            { id: "c7", cat: "combat", name: "APS [STECHKIN]", price: 110000, icon: "üß®", badge: "NEW", rating: "5.0", desc: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ü–∏—Å—Ç–æ–ª–µ—Ç –°—Ç–µ—á–∫–∏–Ω–∞. –†–µ–∂–∏–º –∞–≤—Ç–æ-–æ–≥–Ω—è.\n–ö–∞–ª–∏–±—Ä: 9x18\n–ö–æ–º–ø–ª–µ–∫—Ç: –ö–æ–±—É—Ä–∞-–ø—Ä–∏–∫–ª–∞–¥", reviews: [{u:"vip_client",t:"–†–µ–¥–∫–æ—Å—Ç—å –Ω–µ—Ä–µ–∞–ª—å–Ω–∞—è. –°–æ—Å—Ç–æ—è–Ω–∏–µ –º–∏–Ω—Ç.",r:5}] },
            
            { id: "t1", cat: "traumatic", name: "OSA PB-4-2", price: 14500, icon: "üõ°", badge: null, rating: "4.6", desc: "–ö–æ–º–ø–ª–µ–∫—Å —Å–∞–º–æ–æ–±–æ—Ä–æ–Ω—ã. –≠–ª–µ–∫—Ç—Ä–æ—Å–ø—É—Å–∫. –õ–∞–∑–µ—Ä–Ω—ã–π —Ü–µ–ª–µ—É–∫–∞–∑–∞—Ç–µ–ª—å.\n–ö–∞–ª–∏–±—Ä: 18.5x55", reviews: [{u:"def_user",t:"–í–∞–ª–∏—Ç —Å –Ω–æ–≥. –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ.",r:5}] },
            { id: "t2", cat: "traumatic", name: "PM-T [ZID]", price: 65000, icon: "üí•", badge: "HIT", rating: "4.8", desc: "–ü–µ—Ä–µ–¥–µ–ª–∫–∞ –∏–∑ –±–æ–µ–≤–æ–≥–æ. –°—Ç–≤–æ–ª —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–µ–≥—Ä–∞–¥–∞–º–∏.\n–ö–∞–ª–∏–±—Ä: 9mm PA", reviews: [{u:"killa",t:"–õ—É—á—à–∏–π —Ç—Ä–∞–≤–º–∞—Ç –Ω–∞ —Ä—ã–Ω–∫–µ. –ñ—Ä–µ—Ç –≤—Å—ë.",r:5}] },
            { id: "t3", cat: "traumatic", name: "GRAND POWER T12", price: 42000, icon: "ü¶æ", badge: "TOP", rating: "4.9", desc: "–°–ª–æ–≤–∞–∫–∏—è (–Ω–µ –†–§ —Å–±–æ—Ä–∫–∞). –ü–æ–ª–∏–º–µ—Ä–Ω–∞—è —Ä–∞–º–∫–∞. –ú–æ—â–Ω—ã–π —Å—Ç–≤–æ–ª.\n–ö–∞–ª–∏–±—Ä: 10x28", reviews: [{u:"sport_ipsc",t:"–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –≤—ã—Å–æ—Ç–µ. –≠—Ä–≥–æ–Ω–æ–º–∏–∫–∞ —Å—É–ø–µ—Ä.",r:5}] },
            { id: "t4", cat: "traumatic", name: "TT-T [LEADER]", price: 28000, icon: "üß±", badge: null, rating: "4.5", desc: "–¢—Ä–∞–≤–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¢–¢. –ü–µ—Ä–µ–¥–µ–ª–∫–∞ –ó–∏–î. –ê—É—Ç–µ–Ω—Ç–∏—á–Ω—ã–π –≤–∏–¥.\n–ö–∞–ª–∏–±—Ä: 10x28", reviews: [{u:"old_school",t:"–î–ª—è –¥—É—à–∏ –ø–æ–π–¥–µ—Ç. –ò–Ω–æ–≥–¥–∞ –∫–ª–∏–Ω–∏—Ç –Ω–∞ —Å–ª–∞–±—ã—Ö –ø–∞—Ç—Ä–æ–Ω–∞—Ö.",r:4}] },

            { id: "o1", cat: "other", name: "CRATE 5.45x39", price: 45000, icon: "üì¶", badge: "BULK", rating: "-", desc: "–¶–∏–Ω–∫ 1080—à—Ç. –ì–µ—Ä–º–µ—Ç–∏—á–Ω—ã–π. –ê—Ä–º–µ–π—Å–∫–∏–π –∑–∞–ø–∞—Å.\n–¢–∏–ø: 7–ù6 (–ü–°)", reviews: [] },
            { id: "o2", cat: "other", name: "AMMO 7.62x39", price: 3800, icon: "üíä", badge: null, rating: "-", desc: "–ü–∞—á–∫–∞ 50—à—Ç. –ë–ü–ó/–¢—É–ª–∞.\n–¢–∏–ø: FMJ", reviews: [] },
            { id: "o3", cat: "other", name: "AMMO 9x18 PM", price: 3200, icon: "üç¨", badge: null, rating: "-", desc: "–ü–∞—á–∫–∞ 50—à—Ç. –ü–ü–û/–ü–°.\n–¢–∏–ø: –°—Ç–∞–Ω–¥–∞—Ä—Ç", reviews: [] },
            { id: "o4", cat: "other", name: "AMMO 9x19 LUGER", price: 3500, icon: "üîò", badge: null, rating: "-", desc: "–ü–∞—á–∫–∞ 50—à—Ç. NATO Standard.", reviews: [] },
            { id: "o5", cat: "other", name: "KYDEX HOLSTER", price: 4500, icon: "üëñ", badge: "NEW", rating: "4.7", desc: "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∫–æ–±—É—Ä–∞. –§–æ—Ä–º–æ–≤–∫–∞ –ø–æ–¥ –∑–∞–∫–∞–∑. –ö–ª–∏–ø—Å–∞ —Å—Ç–∞–ª—å.", reviews: [] },
            { id: "o6", cat: "other", name: "HARD CASE IP67", price: 12000, icon: "üß≥", badge: null, rating: "5.0", desc: "–ö–µ–π—Å —É–¥–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π. –ü–æ—Ä–æ–ª–æ–Ω –∫—É–±–∏–∫–∞–º–∏. –í–ª–∞–≥–æ–∑–∞—â–∏—Ç–∞.", reviews: [] }
        ];

        const LOCATIONS = { ru: ["–ú–æ—Å–∫–≤–∞", "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥", "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫"], ua: ["–ö–∏–µ–≤", "–û–¥–µ—Å—Å–∞", "–•–∞—Ä—å–∫–æ–≤", "–õ—å–≤–æ–≤"], kz: ["–ê–ª–º–∞—Ç—ã", "–ê—Å—Ç–∞–Ω–∞", "–®—ã–º–∫–µ–Ω—Ç"], by: ["–ú–∏–Ω—Å–∫", "–ì–æ–º–µ–ª—å"] };
        const WALLETS = { usdt: { addr: "TRxXRhED1G12UEF74riYfkxxws8fKEC4Ca", name: "TRC20", rateId: "tether" }, btc: { addr: "bc1qfutymnq0m7ekah54gxjwq00rdstvg6k0duvdl5", name: "BTC", rateId: "bitcoin" }, ltc: { addr: "ltc1qhnqel0z5qfdl8efyztuu6q2wd6puyfu2u56995", name: "LTC", rateId: "litecoin" } };

        let cart = [];
        let rates = { tether: 98, bitcoin: 9500000, litecoin: 9500 };
        let currentItem = null;
        let timerInt = null;

        function init() {
            renderProducts('all');
            updateCities();
        }

        function renderProducts(filter) {
            const grid = document.getElementById('products-grid');
            grid.innerHTML = '';
            let count = 0;
            const searchQ = document.getElementById('search').value.toLowerCase();

            PRODUCTS.forEach(p => {
                if (filter !== 'all' && p.cat !== filter) return;
                if (searchQ && !p.name.toLowerCase().includes(searchQ)) return;

                const card = document.createElement('div');
                card.className = "panel p-4 flex flex-col hover:bg-[#222] cursor-pointer group transition-colors";
                card.onclick = (e) => { if(!e.target.closest('button')) openProduct(p.id); };

                let badgeHTML = p.badge ? `<span class="text-[9px] border border-blue-900 text-blue-400 px-1 ml-2 font-bold">${p.badge}</span>` : '';

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div class="text-4xl grayscale opacity-80 group-hover:opacity-100 transition-opacity">${p.icon}</div>
                        <div class="text-right">
                            <div class="text-white font-mono font-bold text-sm tracking-tight">${p.price.toLocaleString()} ‚ÇΩ</div>
                            <div class="text-[9px] text-gray-600 font-mono">ID: ${p.id.toUpperCase()}</div>
                        </div>
                    </div>
                    <div class="flex items-center mb-1">
                        <h3 class="font-bold text-gray-200 text-sm group-hover:text-white uppercase tracking-tight">${p.name}</h3>
                        ${badgeHTML}
                    </div>
                    <div class="text-[11px] text-gray-500 mb-4 font-mono leading-tight h-8 overflow-hidden">${p.desc.split('\n')[0]}</div>
                    <div class="mt-auto flex justify-between items-center border-t border-[#333] pt-3">
                        <span class="text-[10px] text-gray-600 font-mono">‚òÖ ${p.rating}</span>
                        <button onclick="addToCart('${p.id}'); event.stopPropagation()" class="text-[10px] text-blue-500 hover:text-white uppercase font-bold tracking-wider transition">[ + –í –ö–û–†–ó–ò–ù–£ ]</button>
                    </div>
                `;
                grid.appendChild(card);
                count++;
            });
            document.getElementById('empty-state').style.display = count === 0 ? 'flex' : 'none';
        }

        function handleSearch() { renderProducts('all'); }

        function openProduct(id) {
            currentItem = PRODUCTS.find(p => p.id === id);
            if (!currentItem) return;
            document.getElementById('pm-icon').textContent = currentItem.icon;
            document.getElementById('pm-name').textContent = currentItem.name;
            document.getElementById('pm-price').textContent = currentItem.price.toLocaleString() + ' ‚ÇΩ';
            document.getElementById('pm-desc').textContent = currentItem.desc;
            document.getElementById('pm-rating').textContent = currentItem.rating;
            document.getElementById('pm-id-display').textContent = currentItem.id.toUpperCase();
            
            const badgeEl = document.getElementById('pm-badge');
            if (currentItem.badge) { badgeEl.textContent = currentItem.badge; badgeEl.classList.remove('hidden'); } 
            else { badgeEl.classList.add('hidden'); }

            const rDiv = document.getElementById('pm-reviews');
            rDiv.innerHTML = currentItem.reviews.length ? currentItem.reviews.map(r => `
                <div class="forum-post">
                    <div class="forum-header">–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨: <span class="text-gray-400">${r.u}</span> | –û–¶–ï–ù–ö–ê: ${r.r}/5</div>
                    <p class="text-xs text-gray-400 italic">"${r.t}"</p>
                </div>`).join('') : '<div class="text-xs text-gray-700 font-mono">[–ù–ï–¢ –ó–ê–ü–ò–°–ï–ô]</div>';
            
            const modal = document.getElementById('product-modal');
            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.add('active'), 10);
            updateCities();
        }

        function addToCartCurrent() { if(currentItem) addToCart(currentItem.id); closeProductModal(); }

        function addToCart(id) {
            const prod = PRODUCTS.find(p => p.id === id);
            cart.push(prod);
            updateCartUI();
            showToast(`–î–û–ë–ê–í–õ–ï–ù–û: ${prod.name}`, 'success');
        }

        function updateCartUI() {
            const badge = document.getElementById('cart-count');
            badge.textContent = cart.length;
            badge.style.display = cart.length > 0 ? 'inline-block' : 'none';
        }

        function openCart() {
            const list = document.getElementById('cart-items');
            list.innerHTML = '';
            let total = 0;

            if (cart.length === 0) {
                document.getElementById('cart-empty').style.display = 'block';
                document.getElementById('cart-summary').style.display = 'none';
            } else {
                document.getElementById('cart-empty').style.display = 'none';
                document.getElementById('cart-summary').style.display = 'block';
                cart.forEach((item, index) => {
                    total += item.price;
                    const el = document.createElement('div');
                    el.className = "flex justify-between items-center border-b border-[#333] py-3 text-xs";
                    el.innerHTML = `
                        <div class="flex items-center gap-3">
                            <span class="grayscale text-lg">${item.icon}</span>
                            <span class="text-gray-300 font-bold uppercase">${item.name}</span>
                        </div>
                        <div class="flex items-center gap-4">
                            <span class="text-gray-500 font-mono">${item.price}</span>
                            <button onclick="removeFromCart(${index})" class="text-red-900 hover:text-red-500 font-bold">[X]</button>
                        </div>
                    `;
                    list.appendChild(el);
                });
            }
            document.getElementById('cart-total').textContent = total.toLocaleString() + ' ‚ÇΩ';
            toCartView();
            const modal = document.getElementById('cart-modal');
            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.add('active'), 10);
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartUI();
            openCart();
        }

        function closeProductModal() { document.getElementById('product-modal').classList.remove('active'); setTimeout(() => document.getElementById('product-modal').classList.add('hidden'), 200); }
        function closeCartModal() { document.getElementById('cart-modal').classList.remove('active'); setTimeout(() => document.getElementById('cart-modal').classList.add('hidden'), 200); clearInterval(timerInt); }
        function closeInfoModal() { document.getElementById('info-modal').classList.remove('active'); setTimeout(() => document.getElementById('info-modal').classList.add('hidden'), 200); }

        function openTextModal(type) {
            const titleEl = document.getElementById('info-title');
            const contentEl = document.getElementById('info-content');
            const modal = document.getElementById('info-modal');
            
            if (type === 'garant') {
                titleEl.textContent = '–ì–ê–†–ê–ù–¢ –°–ï–†–í–ò–°';
                contentEl.innerText = `–ú—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —É—Å–ª—É–≥–∏ –ì–∞—Ä–∞–Ω—Ç–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫.
                
                1. –ü–æ–ª–Ω–∞—è –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω.
                2. –•–æ–ª–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞.
                3. –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å–ø–æ—Ä–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π (–∞—Ä–±–∏—Ç—Ä–∞–∂).
                
                –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞ —Å–æ–≤–µ—Å—Ç—å —É–∂–µ –º–Ω–æ–≥–æ –ª–µ—Ç –∏ –¥–æ—Ä–æ–∂–∏–º —Å–≤–æ–µ–π —Ä–µ–ø—É—Ç–∞—Ü–∏–µ–π. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —à–∏—Ñ—Ä—É—é—Ç—Å—è, –ª–æ–≥–∏ —É–¥–∞–ª—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.`;
            } else if (type === 'rules') {
                titleEl.textContent = '–ü–†–ê–í–ò–õ–ê –°–ï–†–í–ò–°–ê';
                contentEl.innerText = `1. –ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å: –ú—ã –Ω–µ —Ö—Ä–∞–Ω–∏–º –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ.
                2. –û–ø–ª–∞—Ç–∞: –ü—Ä–∏–Ω–∏–º–∞–µ–º —Ç–æ–ª—å–∫–æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É (USDT, BTC, LTC).
                3. –î–æ—Å—Ç–∞–≤–∫–∞: –ö–ª–∞–¥—ã (—Ç–∞–π–Ω–∏–∫–∏) –∏–ª–∏ –∫—É—Ä—å–µ—Ä—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (—á–µ—Ä–µ–∑ –¥—Ä–æ–ø–æ–≤).
                
                –ú—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å. –†–∞–±–æ—Ç–∞–µ–º —á–µ—Å—Ç–Ω–æ –∏ –Ω–∞ —Å–æ–≤–µ—Å—Ç—å. –õ—é–±—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –¥–µ–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–µ—â–µ–Ω—ã.`;
            }
            
            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.add('active'), 10);
        }

        function toCartView() {
            document.getElementById('view-cart-list').classList.remove('hidden');
            document.getElementById('view-checkout').classList.add('hidden');
            document.getElementById('view-invoice').classList.add('hidden');
            document.getElementById('cart-title').textContent = "–ö–û–†–ó–ò–ù–ê";
        }
        function toCheckout() {
            document.getElementById('view-cart-list').classList.add('hidden');
            document.getElementById('view-checkout').classList.remove('hidden');
            document.getElementById('cart-title').textContent = "–û–§–û–†–ú–õ–ï–ù–ò–ï –ó–ê–ö–ê–ó–ê";
            updateCities();
        }
        function toInvoice() {
            const payMethod = document.querySelector('input[name="payment"]:checked').value;
            const total = cart.reduce((sum, i) => sum + i.price, 0);
            const wallet = WALLETS[payMethod];
            const amount = (total / rates[wallet.rateId]).toFixed(payMethod === 'btc' ? 6 : 4);

            document.getElementById('inv-rub').textContent = total.toLocaleString() + ' RUB';
            document.getElementById('inv-crypto').textContent = `${amount} ${wallet.name}`;
            document.getElementById('inv-wallet-name').textContent = wallet.name;
            document.getElementById('inv-addr').textContent = wallet.addr;

            document.getElementById('view-checkout').classList.add('hidden');
            document.getElementById('view-invoice').classList.remove('hidden');
            startTimer();
        }

        function updateCities() {
            const c = document.getElementById('country').value;
            const s = document.getElementById('city');
            s.innerHTML = '';
            LOCATIONS[c].forEach(city => {
                const opt = document.createElement('option');
                opt.value = city;
                opt.textContent = city;
                s.appendChild(opt);
            });
        }

        function startTimer() {
            clearInterval(timerInt);
            let t = 900; 
            const el = document.getElementById('timer');
            const tick = () => {
                const m = Math.floor(t / 60).toString().padStart(2, '0');
                const s = (t % 60).toString().padStart(2, '0');
                el.textContent = `${m}:${s}`;
                if (--t < 0) { clearInterval(timerInt); el.textContent = "–í–†–ï–ú–Ø –ò–°–¢–ï–ö–õ–û"; showToast('–°–ï–°–°–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê', 'error'); }
            };
            tick();
            timerInt = setInterval(tick, 1000);
        }

        function copyWallet() {
            navigator.clipboard.writeText(document.getElementById('inv-addr').textContent);
            showToast('–°–ö–û–ü–ò–†–û–í–ê–ù–û –í –ë–£–§–ï–†', 'success');
        }

        function showToast(msg, type) {
            const box = document.getElementById('toast-container');
            const el = document.createElement('div');
            const color = type === 'success' ? 'border-green-600 text-green-500' : 'border-red-800 text-red-500';
            el.className = `toast p-3 mb-2 bg-[#111] border-l-4 ${color} shadow-lg uppercase font-bold text-xs tracking-wider flex items-center gap-2`;
            el.innerHTML = `<span>></span> ${msg}`;
            box.appendChild(el);
            setTimeout(() => { el.remove(); }, 3000);
        }

        init();
    </script>
</body>
</html>
