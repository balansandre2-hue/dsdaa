<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TacticalShop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gray: {
                            850: '#1f2937',
                            900: '#111827',
                            950: '#0b0f19',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap');
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #0b0f19;
            color: #f3f4f6;
        }
        .modal { transition: opacity 0.25s ease; }
        body.modal-active { overflow: hidden; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .product-card { animation: fadeIn 0.4s ease-out forwards; }
        .toast-container {
            position: fixed; bottom: 20px; right: 20px; z-index: 100;
            display: flex; flex-direction: column; gap: 10px;
        }
        .toast {
            background: #1f2937; border-left: 4px solid #2563eb; color: white;
            padding: 12px 20px; border-radius: 4px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            display: flex; align-items: center; animation: slideIn 0.3s ease-out; min-width: 250px;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        /* –°–∫—Ä–æ–ª–ª–±–∞—Ä –¥–ª—è Webkit */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #111827; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #4b5563; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="bg-gray-900 border-b border-gray-800 sticky top-0 z-40 shadow-lg backdrop-blur-md bg-opacity-90">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16 gap-4">
                <div class="flex items-center flex-shrink-0 cursor-pointer" onclick="filterProducts('all')">
                    <div class="text-blue-600 font-black text-2xl tracking-tighter">
                        TS <span class="hidden sm:inline text-gray-100 text-lg font-bold tracking-normal">TacticalShop</span>
                    </div>
                </div>

                <div class="flex-grow max-w-md mx-4">
                    <div class="relative">
                        <input type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä: AK, –ü–ú)..." class="w-full bg-gray-800 text-gray-300 border border-gray-700 rounded-full py-1.5 px-4 pl-10 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 text-sm transition" oninput="handleSearch(this.value)">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <svg class="h-4 w-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                        </div>
                    </div>
                </div>

                <div class="flex items-center gap-4">
                    <div class="hidden md:flex items-baseline space-x-2">
                        <button onclick="filterProducts('all')" class="nav-btn text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition hover:bg-gray-800">–í—Å–µ</button>
                        <button onclick="filterProducts('combat')" class="nav-btn text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition hover:bg-gray-800">–ë–æ–µ–≤–æ–µ</button>
                        <button onclick="filterProducts('traumatic')" class="nav-btn text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition hover:bg-gray-800">–¢—Ä–∞–≤–º–∞—Ç</button>
                        <button onclick="filterProducts('other')" class="nav-btn text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition hover:bg-gray-800">–°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ</button>
                    </div>
                    <a href="https://t.me/+l4Mt8VCqCf42ZDU5" target="_blank" class="text-gray-400 hover:text-white text-sm font-medium transition hidden sm:block">–û—Ç–∑—ã–≤—ã</a>
                    <div class="bg-green-600/20 text-green-400 border border-green-600/30 px-3 py-1 rounded text-xs font-bold shadow-[0_0_10px_rgba(34,197,94,0.2)]">ONLINE</div>
                </div>
            </div>
        </div>
        <div class="md:hidden flex justify-start gap-2 bg-gray-950 p-2 overflow-x-auto border-t border-gray-800 scrollbar-hide">
            <button onclick="filterProducts('combat')" class="flex-shrink-0 text-xs text-gray-300 px-4 py-1.5 bg-gray-900 border border-gray-700 rounded-full whitespace-nowrap active:bg-gray-800">üî• –ë–æ–µ–≤–æ–µ</button>
            <button onclick="filterProducts('traumatic')" class="flex-shrink-0 text-xs text-gray-300 px-4 py-1.5 bg-gray-900 border border-gray-700 rounded-full whitespace-nowrap active:bg-gray-800">üõ° –¢—Ä–∞–≤–º–∞—Ç</button>
            <button onclick="filterProducts('other')" class="flex-shrink-0 text-xs text-gray-300 px-4 py-1.5 bg-gray-900 border border-gray-700 rounded-full whitespace-nowrap active:bg-gray-800">üì¶ –°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
        <div class="text-center mb-10 relative">
            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-blue-900/20 rounded-full blur-3xl -z-10"></div>
            <h1 class="text-4xl tracking-tight font-extrabold text-white sm:text-5xl md:text-6xl">
                <span class="block xl:inline">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ</span>
                <span class="block text-blue-600 xl:inline bg-clip-text text-transparent bg-gradient-to-r from-blue-500 to-blue-700">–≤–æ–æ—Ä—É–∂–µ–Ω–∏–µ</span>
            </h1>
            <p class="mt-3 max-w-md mx-auto text-base text-gray-400 sm:text-lg md:mt-5 md:text-xl md:max-w-3xl">
                –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å. –ü—Ä—è–º—ã–µ –ø–æ—Å—Ç–∞–≤–∫–∏.
            </p>
        </div>

        <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
        
        <div id="no-results" class="hidden text-center py-12">
            <p class="text-gray-500 text-lg">–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>
            <button onclick="document.getElementById('search-input').value=''; handleSearch('')" class="mt-4 text-blue-400 hover:underline">–°–±—Ä–æ—Å–∏—Ç—å –ø–æ–∏—Å–∫</button>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 border-t border-gray-800 mt-auto">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <p class="text-center text-gray-500 text-sm">
                &copy; 2026 TacticalShop. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã. –†–∞–±–æ—Ç–∞–µ–º –∞–Ω–æ–Ω–∏–º–Ω–æ.
            </p>
        </div>
    </footer>

    <!-- Modal -->
    <div id="modal" class="modal opacity-0 pointer-events-none fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeModal()"></div>
        <div class="modal-container bg-gray-900 w-full max-w-md mx-auto rounded-xl shadow-2xl z-50 overflow-hidden border border-gray-700 flex flex-col max-h-[90vh]">
            
            <div class="flex justify-between items-center px-6 py-4 border-b border-gray-800 bg-gray-900">
                <p class="text-lg font-bold text-white" id="modal-title">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</p>
                <div class="cursor-pointer text-gray-400 hover:text-white transition" onclick="closeModal()">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </div>
            </div>

            <div class="overflow-y-auto p-6 custom-scrollbar bg-gray-900">
                <!-- Step 1 -->
                <div id="step-1">
                    <div class="flex gap-4 mb-6 bg-gray-800 p-3 rounded-lg border border-gray-700">
                        <img id="modal-img" src="" class="w-24 h-24 object-cover rounded bg-gray-950" onerror="this.src='https://dummyimage.com/150x150/1f2937/6b7280&text=No+Image'">
                        <div>
                            <h3 id="modal-product-name" class="font-bold text-white text-sm sm:text-base mb-1"></h3>
                            <p id="modal-product-price" class="text-blue-500 font-bold text-lg"></p>
                            <span class="text-xs text-green-500 mt-1 block">‚óè –í –Ω–∞–ª–∏—á–∏–∏</span>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-gray-400 text-xs font-bold mb-1 uppercase tracking-wide">–°—Ç—Ä–∞–Ω–∞</label>
                            <select id="country-select" class="w-full bg-gray-950 text-white border border-gray-700 rounded-lg py-2.5 px-3 focus:outline-none focus:border-blue-500 transition" onchange="updateCities()">
                                <option value="ru">üá∑üá∫ –†–æ—Å—Å–∏—è</option>
                                <option value="ua">üá∫üá¶ –£–∫—Ä–∞–∏–Ω–∞</option>
                                <option value="kz">üá∞üáø –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω</option>
                                <option value="by">üáßüáæ –ë–µ–ª–∞—Ä—É—Å—å</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-400 text-xs font-bold mb-1 uppercase tracking-wide">–ì–æ—Ä–æ–¥</label>
                            <select id="city-select" class="w-full bg-gray-950 text-white border border-gray-700 rounded-lg py-2.5 px-3 focus:outline-none focus:border-blue-500 transition"></select>
                        </div>
                        <div>
                            <label class="block text-gray-400 text-xs font-bold mb-1 uppercase tracking-wide">–î–æ—Å—Ç–∞–≤–∫–∞</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="cursor-pointer relative">
                                    <input type="radio" name="delivery" value="courier" class="peer sr-only" checked>
                                    <div class="text-center py-3 bg-gray-800 peer-checked:bg-blue-600 peer-checked:text-white text-gray-300 rounded-lg transition border border-gray-700 peer-checked:border-blue-500 hover:bg-gray-700">
                                        <div class="text-sm font-bold">üèÉ –ö—É—Ä—å–µ—Ä</div>
                                        <div class="text-[10px] opacity-75">–í —Ä—É–∫–∏</div>
                                    </div>
                                </label>
                                <label class="cursor-pointer relative">
                                    <input type="radio" name="delivery" value="drop" class="peer sr-only">
                                    <div class="text-center py-3 bg-gray-800 peer-checked:bg-blue-600 peer-checked:text-white text-gray-300 rounded-lg transition border border-gray-700 peer-checked:border-blue-500 hover:bg-gray-700">
                                        <div class="text-sm font-bold">üìç –¢–∞–π–Ω–∏–∫</div>
                                        <div class="text-[10px] opacity-75">–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                        <div>
                            <label class="block text-gray-400 text-xs font-bold mb-1 uppercase tracking-wide">–û–ø–ª–∞—Ç–∞</label>
                            <div class="space-y-2">
                                <label class="cursor-pointer block relative">
                                    <input type="radio" name="payment" value="usdt" class="peer sr-only" checked>
                                    <div class="flex items-center justify-between p-3 bg-gray-800 rounded-lg border border-gray-700 peer-checked:border-blue-500 hover:bg-gray-700 transition">
                                        <span class="flex items-center text-sm font-medium"><span class="mr-2 text-xl">üíé</span> USDT (TRC20)</span>
                                        <div class="w-4 h-4 rounded-full border border-gray-500 peer-checked:bg-blue-500 peer-checked:border-blue-500"></div>
                                    </div>
                                </label>
                                <label class="cursor-pointer block relative">
                                    <input type="radio" name="payment" value="btc" class="peer sr-only">
                                    <div class="flex items-center justify-between p-3 bg-gray-800 rounded-lg border border-gray-700 peer-checked:border-blue-500 hover:bg-gray-700 transition">
                                        <span class="flex items-center text-sm font-medium"><span class="mr-2 text-xl">‚Çø</span> Bitcoin</span>
                                        <div class="w-4 h-4 rounded-full border border-gray-500 peer-checked:bg-blue-500 peer-checked:border-blue-500"></div>
                                    </div>
                                </label>
                                <label class="cursor-pointer block relative">
                                    <input type="radio" name="payment" value="ltc" class="peer sr-only">
                                    <div class="flex items-center justify-between p-3 bg-gray-800 rounded-lg border border-gray-700 peer-checked:border-blue-500 hover:bg-gray-700 transition">
                                        <span class="flex items-center text-sm font-medium"><span class="mr-2 text-xl">≈Å</span> Litecoin</span>
                                        <div class="w-4 h-4 rounded-full border border-gray-500 peer-checked:bg-blue-500 peer-checked:border-blue-500"></div>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                    <button onclick="goToInvoice()" class="w-full mt-6 bg-blue-600 hover:bg-blue-500 text-white font-bold py-3.5 px-4 rounded-lg shadow-lg transform transition active:scale-[0.98]">–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ</button>
                </div>

                <!-- Step 2 -->
                <div id="step-2" class="hidden text-center py-2">
                    <div class="flex justify-center mb-4">
                         <div class="w-16 h-16 bg-blue-900/30 text-blue-500 rounded-full flex items-center justify-center text-3xl animate-pulse ring-1 ring-blue-500/50">üßæ</div>
                    </div>
                    <h3 class="text-xl font-bold mb-1 text-white">–û–∂–∏–¥–∞–Ω–∏–µ –æ–ø–ª–∞—Ç—ã</h3>
                    <div class="text-3xl font-mono text-red-500 font-bold mb-4 tracking-wider" id="timer">15:00</div>
                    <p class="text-sm text-gray-400 mb-4 px-2">–ó–∞–∫–∞–∑ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ —Ç–æ—á–Ω—É—é —Å—É–º–º—É.</p>
                    
                    <div class="bg-gray-950 border border-gray-800 p-4 rounded-lg mb-6 text-left shadow-inner">
                        <div class="flex justify-between mb-2 pb-2 border-b border-gray-800">
                            <span class="text-gray-400 text-sm">–°—É–º–º–∞ (RUB):</span>
                            <span id="invoice-rub" class="font-bold text-gray-200"></span>
                        </div>
                        <div class="flex justify-between mb-4">
                            <span class="text-gray-400 text-sm">–ö –æ–ø–ª–∞—Ç–µ:</span>
                            <span id="invoice-crypto" class="font-bold text-green-400 text-lg"></span>
                        </div>
                        <div>
                            <span class="text-gray-500 text-[10px] uppercase tracking-wider font-bold mb-1 block">–ê–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞ (<span id="wallet-label"></span>)</span>
                            <div class="flex items-center bg-gray-900 border border-gray-700 p-2.5 rounded group hover:border-blue-500 transition cursor-pointer" onclick="copyAddress()">
                                <input type="text" id="wallet-address" class="bg-transparent border-none text-xs w-full text-gray-300 font-mono focus:ring-0 cursor-pointer select-all" readonly>
                                <svg class="w-4 h-4 text-gray-500 group-hover:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="showToast('–ü–ª–∞—Ç–µ–∂ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è... –û–∂–∏–¥–∞–π—Ç–µ.', 'info'); closeModal()" class="w-full bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 rounded-lg mb-3 transition border border-gray-700">–Ø –æ–ø–ª–∞—Ç–∏–ª</button>
                    <button onclick="backToStep1()" class="text-sm text-gray-500 hover:text-white transition underline">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</button>
                </div>
            </div>
        </div>
    </div>

    <div id="toast-container" class="toast-container"></div>

    <script>
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ URL —Å Wikimedia Commons
        const PRODUCTS = {
            combat: [
                { id: "com_ak74m", name: "AK-74M (–ò–∂–ú–∞—à)", price: 45000, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/AK-74_new.jpg/640px-AK-74_new.jpg", badge: "HIT", desc: "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –±–æ–µ–≤–æ–π –∞–≤—Ç–æ–º–∞—Ç.\n–°–ø–∏—Å–∞–Ω–Ω–æ–µ –±–æ–µ–≤–æ–µ, –Ω–µ –æ—Ö–æ–ª–æ—â–µ–Ω–Ω–æ–µ.\nüõ† –¢–¢–•: –ö–∞–ª–∏–±—Ä 5.45—Ö39–º–º." },
                { id: "com_aks74u", name: "–ê–ö–°-74–£ ¬´–ö—Å—é—Ö–∞¬ª", price: 52000, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/AKS-74U_noBG.png/640px-AKS-74U_noBG.png", badge: null, desc: "–£–∫–æ—Ä–æ—á–µ–Ω–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç –ö–∞–ª–∞—à–Ω–∏–∫–æ–≤–∞.\n–ò–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ.\nüõ† –¢–¢–•: –ö–∞–ª–∏–±—Ä 5.45—Ö39–º–º." },
                { id: "com_akm", name: "–ê–ö–ú (1960-–µ)", price: 48000, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/f/f6/AKM_rifle.jpg/640px-AKM_rifle.jpg", badge: "RARE", desc: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –∫–∞–ª–∏–±—Ä 7.62.\n–ü—Ä–æ–±–∏–≤–∞–µ—Ç –∫–∏—Ä–ø–∏—á–Ω—É—é –∫–ª–∞–¥–∫—É.\nüõ† –¢–¢–•: –ö–∞–ª–∏–±—Ä 7.62—Ö39–º–º." },
                { id: "com_svd", name: "–°–í–î (–î—Ä–∞–≥—É–Ω–æ–≤)", price: 85000, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/SVD_Dragunov_Tiger.jpg/640px-SVD_Dragunov_Tiger.jpg", badge: null, desc: "–°–Ω–∞–π–ø–µ—Ä—Å–∫–∞—è –í–∏–Ω—Ç–æ–≤–∫–∞ –î—Ä–∞–≥—É–Ω–æ–≤–∞.\n–í –∫–æ–º–ø–ª–µ–∫—Ç–µ –ø—Ä–∏—Ü–µ–ª –ü–°–û-1.\nüõ† –¢–¢–•: –ö–∞–ª–∏–±—Ä 7.62—Ö54R." },
                { id: "com_pm", name: "–ü–ú (–ú–∞–∫–∞—Ä–æ–≤)", price: 25000, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Makarov_PM.jpg/640px-Makarov_PM.jpg", badge: "HIT", desc: "–ë–æ–µ–≤–æ–π –ü–∏—Å—Ç–æ–ª–µ—Ç –ú–∞–∫–∞—Ä–æ–≤–∞ (–°–°–°–†).\n–ù–∞—Ä–µ–∑–Ω–æ–π —Å—Ç–≤–æ–ª, –≤–æ—Ä–æ–Ω–µ–Ω–∞—è —Å—Ç–∞–ª—å.\nüõ† –¢–¢–•: –ö–∞–ª–∏–±—Ä 9—Ö18 –ü–ú." },
                { id: "com_tt", name: "–¢–¢-33 (–¢—É–ª—å—Å–∫–∏–π)", price: 32000, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/33/Tokarev_TT-33.jpg/640px-Tokarev_TT-33.jpg", badge: null, desc: "–ü–∏—Å—Ç–æ–ª–µ—Ç –¢–æ–∫–∞—Ä–µ–≤–∞, –≤–æ–µ–Ω–Ω—ã–π –≤—ã–ø—É—Å–∫.\n–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —à—Ç–∏—Ñ—Ç—ã –≤ —Å—Ç–≤–æ–ª–µ.\nüõ† –¢–¢–•: –ö–∞–ª–∏–±—Ä 7.62—Ö25 –¢–¢." },
                { id: "com_aps", name: "–ê–ü–° (–°—Ç–µ—á–∫–∏–Ω)", price: 110000, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/Stechkin_APS.jpg/640px-Stechkin_APS.jpg", badge: "NEW", desc: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ü–∏—Å—Ç–æ–ª–µ—Ç –°—Ç–µ—á–∫–∏–Ω–∞.\n–†–µ–∂–∏–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–≥–Ω—è.\nüõ† –¢–¢–•: –ö–∞–ª–∏–±—Ä 9—Ö18 –ü–ú." }
            ],
            traumatic: [
                { id: "tr_osa", name: "–û—Å–∞ –ü–ë-4-1", price: 14500, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/52/PB-4-1_Osa.jpg/640px-PB-4-1_Osa.jpg", badge: null, desc: "–ë–µ—Å—Å—Ç–≤–æ–ª—å–Ω—ã–π –ø–∏—Å—Ç–æ–ª–µ—Ç —Å–∞–º–æ–æ–±–æ—Ä–æ–Ω—ã.\n–ú–æ—â–Ω–µ–π—à–∏–π —Ç—Ä–∞–≤–º–∞—Ç.\nüõ† –¢–¢–•: 18.5—Ö55–º–º." },
                { id: "tr_grand", name: "Grand Power K100", price: 42000, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/be/Grand_Power_K100.jpg/640px-Grand_Power_K100.jpg", badge: "TOP", desc: "–°–ª–æ–≤–∞—Ü–∫–∏–π –ø–∏—Å—Ç–æ–ª–µ—Ç (—Å–±–æ—Ä–∫–∞ –†–§).\n–≠—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π, –º–æ—â–Ω—ã–π.\nüõ† –¢–¢–•: –ö–∞–ª–∏–±—Ä 10—Ö28." }
            ],
            other: [
                { id: "acc_ammo_545", name: "–¶–∏–Ω–∫ 5.45—Ö39", price: 45000, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a4/5.45x39_cartridges.jpg/640px-5.45x39_cartridges.jpg", badge: "BULK", desc: "–ê—Ä–º–µ–π—Å–∫–∏–π –≥–µ—Ä–º–µ—Ç–∏—á–Ω—ã–π —Ü–∏–Ω–∫.\n–î–ª—è AK-74M, –ê–ö–°-74–£.\nüõ† –§–∞—Å–æ–≤–∫–∞: 1080 —à—Ç." },
                { id: "acc_ammo_762_39", name: "–ü–∞—Ç—Ä–æ–Ω—ã 7.62—Ö39", price: 3800, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/62/7.62x39mm_rounds.jpg/640px-7.62x39mm_rounds.jpg", badge: null, desc: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –∫–∞–ª–∏–±—Ä.\n–î–ª—è –ê–ö–ú.\nüõ† –§–∞—Å–æ–≤–∫–∞: 50 —à—Ç." },
                { id: "acc_ammo_762_54", name: "–ü–∞—Ç—Ä–æ–Ω—ã 7.62—Ö54R", price: 4200, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/7.62x54mmR_cartridges.jpg/640px-7.62x54mmR_cartridges.jpg", badge: null, desc: "–í–∏–Ω—Ç–æ–≤–æ—á–Ω—ã–π –ø–∞—Ç—Ä–æ–Ω.\n–î–ª—è –°–í–î.\nüõ† –§–∞—Å–æ–≤–∫–∞: 20 —à—Ç." },
                { id: "acc_ammo_918", name: "–ü–∞—Ç—Ä–æ–Ω—ã 9x18 –ü–ú", price: 3200, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/9x18mm_Makarov.jpg/640px-9x18mm_Makarov.jpg", badge: "HIT", desc: "–®—Ç–∞—Ç–Ω—ã–π –ø–∞—Ç—Ä–æ–Ω –ü–ú.\n–î–ª—è –ü–ú, –ê–ü–°.\nüõ† –§–∞—Å–æ–≤–∫–∞: 50 —à—Ç." },
                { id: "acc_ammo_762_25", name: "–ü–∞—Ç—Ä–æ–Ω—ã 7.62—Ö25 –¢–¢", price: 4000, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6a/7.62x25mm_Tokarev.jpg/640px-7.62x25mm_Tokarev.jpg", badge: null, desc: "–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–±–∏–≤–∞–µ–º–æ—Å—Ç—å.\n–î–ª—è –¢–¢-33.\nüõ† –§–∞—Å–æ–≤–∫–∞: 50 —à—Ç." },
                { id: "acc_ammo_1845", name: "–ü–∞—Ç—Ä–æ–Ω—ã 18.5—Ö55", price: 2500, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a8/18x45_cartridge.jpg/640px-18x45_cartridge.jpg", badge: null, desc: "–¢—Ä–∞–≤–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ä–æ–Ω.\n–î–ª—è –∫–æ–º–ø–ª–µ–∫—Å–∞ –û—Å–∞.\nüõ† –§–∞—Å–æ–≤–∫–∞: 4 —à—Ç." },
                { id: "acc_ammo_1028", name: "–ü–∞—Ç—Ä–æ–Ω—ã 10—Ö28", price: 3500, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/14/9mm_PA_rubber.jpg/640px-9mm_PA_rubber.jpg", badge: null, desc: "–¢—Ä–∞–≤–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ä–æ–Ω.\n–î–ª—è Grand Power.\nüõ† –§–∞—Å–æ–≤–∫–∞: 25 —à—Ç." },
                { id: "acc_holster", name: "–ö–æ–±—É—Ä–∞ Kydex", price: 4500, image: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5d/Kydex_Holster.jpg/640px-Kydex_Holster.jpg", badge: "NEW", desc: "–ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–æ–±—É—Ä–∞ –∏–∑ –∫–∞–π–¥–µ–∫—Å–∞.\n–°–∫—Ä—ã—Ç–æ–µ –Ω–æ—à–µ–Ω–∏–µ (IWB).\nüõ† –ú–∞—Ç–µ—Ä–∏–∞–ª: Kydex 2mm." },
                { id: "acc_case", name: "–ö–µ–π—Å –æ—Ä—É–∂–µ–π–Ω—ã–π", price: 12000, image: "https://images.unsplash.com/photo-1541696884-2e4fb8078396?auto=format&fit=crop&w=640&q=80", badge: null, desc: "–£–¥–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π, –≤–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º—ã–π.\n–ü–æ—Ä–æ–ª–æ–Ω–æ–≤—ã–π –ª–æ–∂–µ–º–µ–Ω—Ç.\nüõ† –ó–∞—â–∏—Ç–∞: IP67." }
            ]
        };

        const LOCATIONS = {
            ru: ["–ú–æ—Å–∫–≤–∞", "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥", "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥", "–ö–∞–∑–∞–Ω—å"],
            ua: ["–ö–∏–µ–≤", "–•–∞—Ä—å–∫–æ–≤", "–û–¥–µ—Å—Å–∞", "–î–Ω–µ–ø—Ä", "–õ—å–≤–æ–≤"],
            kz: ["–ê–ª–º–∞—Ç—ã", "–ê—Å—Ç–∞–Ω–∞", "–®—ã–º–∫–µ–Ω—Ç", "–ê–∫—Ç–æ–±–µ", "–ö–∞—Ä–∞–≥–∞–Ω–¥–∞"],
            by: ["–ú–∏–Ω—Å–∫", "–ì–æ–º–µ–ª—å", "–ú–æ–≥–∏–ª–µ–≤", "–í–∏—Ç–µ–±—Å–∫", "–ì—Ä–æ–¥–Ω–æ"]
        };

        const WALLETS = {
            usdt: { addr: "TRxXRhED1G12UEF74riYfkxxws8fKEC4Ca", name: "USDT (TRC20)", rateId: "tether" },
            btc: { addr: "bc1qfutymnq0m7ekah54gxjwq00rdstvg6k0duvdl5", name: "Bitcoin", rateId: "bitcoin" },
            ltc: { addr: "ltc1qhnqel0z5qfdl8efyztuu6q2wd6puyfu2u56995", name: "Litecoin", rateId: "litecoin" }
        };

        let currentProduct = null;
        let rates = { tether: 100, bitcoin: 9000000, litecoin: 10000 }; 
        let searchFilter = '';
        let timerInterval;

        async function fetchRates() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=tether,bitcoin,litecoin&vs_currencies=rub');
                const data = await response.json();
                if(data.tether) rates.tether = data.tether.rub;
                if(data.bitcoin) rates.bitcoin = data.bitcoin.rub;
                if(data.litecoin) rates.litecoin = data.litecoin.rub;
            } catch (e) {
                console.log('API rate error, defaults used');
            }
        }

        function renderProducts(categoryFilter = 'all') {
            const grid = document.getElementById('products-grid');
            grid.innerHTML = '';
            let hasResults = false;
            
            Object.keys(PRODUCTS).forEach(cat => {
                if(categoryFilter === 'all' || categoryFilter === cat) {
                    PRODUCTS[cat].forEach(p => {
                        if(searchFilter && !p.name.toLowerCase().includes(searchFilter.toLowerCase())) return;
                        hasResults = true;
                        
                        let badgeHtml = '';
                        if(p.badge === 'HIT') badgeHtml = `<div class="absolute top-2 left-2 bg-red-600/90 text-white text-[10px] font-bold px-2 py-1 rounded shadow backdrop-blur-sm">HIT üî•</div>`;
                        else if(p.badge === 'NEW') badgeHtml = `<div class="absolute top-2 left-2 bg-blue-600/90 text-white text-[10px] font-bold px-2 py-1 rounded shadow backdrop-blur-sm">NEW ‚ú®</div>`;
                        else if(p.badge === 'RARE') badgeHtml = `<div class="absolute top-2 left-2 bg-purple-600/90 text-white text-[10px] font-bold px-2 py-1 rounded shadow backdrop-blur-sm">RARE üíé</div>`;
                        else if(p.badge === 'TOP') badgeHtml = `<div class="absolute top-2 left-2 bg-yellow-600/90 text-white text-[10px] font-bold px-2 py-1 rounded shadow backdrop-blur-sm">TOP üèÜ</div>`;
                        else if(p.badge === 'BULK') badgeHtml = `<div class="absolute top-2 left-2 bg-green-600/90 text-white text-[10px] font-bold px-2 py-1 rounded shadow backdrop-blur-sm">BULK üì¶</div>`;

                        const el = document.createElement('div');
                        el.className = 'product-card bg-gray-900 rounded-xl shadow-lg overflow-hidden border border-gray-800 hover:border-blue-600/30 transition duration-300 flex flex-col group relative';
                        el.innerHTML = `
                            <div class="h-48 overflow-hidden relative bg-gray-950">
                                ${badgeHtml}
                                <img src="${p.image}" alt="${p.name}" class="w-full h-full object-cover opacity-90 group-hover:opacity-100 group-hover:scale-110 transition duration-500" onerror="this.src='https://dummyimage.com/600x400/1f2937/6b7280&text=No+Image'">
                                <div class="absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent opacity-80"></div>
                            </div>
                            <div class="p-4 flex-grow flex flex-col relative">
                                <h3 class="text-lg font-bold text-gray-100 mb-1 group-hover:text-blue-500 transition">${p.name}</h3>
                                <p class="text-gray-400 text-xs mb-4 whitespace-pre-line flex-grow leading-relaxed">${p.desc}</p>
                                <div class="flex justify-between items-center mt-auto pt-3 border-t border-gray-800">
                                    <span class="text-xl font-bold text-gray-200">${p.price.toLocaleString()} ‚ÇΩ</span>
                                    <button onclick='openModal(${JSON.stringify(p)})' class="bg-gray-800 hover:bg-blue-600 text-gray-200 hover:text-white px-4 py-2 rounded-lg text-sm font-bold transition border border-gray-700 hover:border-blue-500">–ö—É–ø–∏—Ç—å</button>
                                </div>
                            </div>
                        `;
                        grid.appendChild(el);
                    });
                }
            });

            const noResults = document.getElementById('no-results');
            if (!hasResults) {
                noResults.classList.remove('hidden');
            } else {
                noResults.classList.add('hidden');
            }
        }

        function filterProducts(cat) { renderProducts(cat); }
        function handleSearch(val) { searchFilter = val; renderProducts(); }

        function openModal(product) {
            currentProduct = product;
            document.getElementById('modal').classList.remove('opacity-0', 'pointer-events-none');
            document.body.classList.add('modal-active');
            
            document.getElementById('modal-img').src = product.image;
            document.getElementById('modal-product-name').textContent = product.name;
            document.getElementById('modal-product-price').textContent = product.price.toLocaleString() + ' ‚ÇΩ';
            
            backToStep1();
            updateCities();
        }

        function closeModal() {
            document.getElementById('modal').classList.add('opacity-0', 'pointer-events-none');
            document.body.classList.remove('modal-active');
            clearInterval(timerInterval);
        }

        function updateCities() {
            const country = document.getElementById('country-select').value;
            const citySelect = document.getElementById('city-select');
            citySelect.innerHTML = '';
            LOCATIONS[country].forEach(city => {
                const opt = document.createElement('option');
                opt.value = city;
                opt.textContent = city;
                citySelect.appendChild(opt);
            });
        }

        function goToInvoice() {
            const paymentType = document.querySelector('input[name="payment"]:checked').value;
            const walletData = WALLETS[paymentType];
            const rubPrice = currentProduct.price;
            const rate = rates[walletData.rateId];
            const cryptoAmount = (rubPrice / rate).toFixed(paymentType === 'btc' ? 6 : paymentType === 'ltc' ? 4 : 2);

            document.getElementById('step-1').classList.add('hidden');
            document.getElementById('step-2').classList.remove('hidden');

            document.getElementById('invoice-rub').textContent = rubPrice.toLocaleString() + ' RUB';
            document.getElementById('invoice-crypto').textContent = `${cryptoAmount} ${paymentType.toUpperCase()}`;
            document.getElementById('wallet-label').textContent = walletData.name;
            document.getElementById('wallet-address').value = walletData.addr;
            
            startTimer(15 * 60); 
            showToast('–ò–Ω–≤–æ–π—Å —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω', 'success');
        }

        function backToStep1() {
            document.getElementById('step-1').classList.remove('hidden');
            document.getElementById('step-2').classList.add('hidden');
            clearInterval(timerInterval);
        }

        function startTimer(duration) {
            clearInterval(timerInterval);
            let timer = duration, minutes, seconds;
            const display = document.getElementById('timer');
            
            timerInterval = setInterval(function () {
                minutes = parseInt(timer / 60, 10);
                seconds = parseInt(timer % 60, 10);
                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;
                display.textContent = minutes + ":" + seconds;
                if (--timer < 0) {
                    clearInterval(timerInterval);
                    display.textContent = "00:00";
                    showToast('–í—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—è –∏—Å—Ç–µ–∫–ª–æ', 'error');
                }
            }, 1000);
        }

        function copyAddress() {
            const copyText = document.getElementById("wallet-address");
            copyText.select();
            document.execCommand("copy");
            showToast("–ê–¥—Ä–µ—Å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω", "success");
        }

        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            let borderClass = type === 'success' ? 'border-green-500' : type === 'error' ? 'border-red-500' : 'border-blue-500';
            let icon = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ö†Ô∏è' : 'üîî';
            toast.className = `toast ${borderClass} bg-gray-800 text-white px-4 py-3 rounded shadow-lg flex items-center gap-3 transform transition-all duration-300`;
            toast.innerHTML = `<span class="text-lg">${icon}</span><span class="text-sm font-medium">${message}</span>`;
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        fetchRates();
        renderProducts();
    </script>
</body>
</html>
