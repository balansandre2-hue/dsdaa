<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TacticalShop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        const origWarn = console.warn;
        console.warn = (...args) => {
            if (args[0] && typeof args[0] === 'string' && args[0].includes('cdn.tailwindcss.com')) return;
            origWarn.apply(console, args);
        };
        
        tailwind.config = {
            theme: {
                extend: {
                    colors: { gray: { 850: '#1f2937', 900: '#111827', 950: '#0b0f19' } }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0b0f19; color: #f3f4f6; }
        .modal { transition: opacity 0.2s ease, visibility 0.2s; visibility: hidden; opacity: 0; }
        .modal.active { visibility: visible; opacity: 1; }
        body.modal-open { overflow: hidden; }
        .product-card { transition: all 0.2s ease; }
        .product-card:hover { transform: translateY(-4px); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5); }
        .icon-box { background: radial-gradient(circle at center, #1f2937 0%, #111827 100%); }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #111827; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 3px; }
        .toast { animation: slideIn 0.3s ease-out forwards; }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .cart-badge { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popIn { 0% { transform: scale(0); } 100% { transform: scale(1); } }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="bg-gray-900/90 backdrop-blur-md border-b border-gray-800 sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-2 cursor-pointer" onclick="renderProducts('all')">
                    <div class="bg-blue-600 text-white font-bold rounded p-1 text-xs">TS</div>
                    <span class="font-bold text-xl tracking-tight text-white hidden sm:block">TacticalShop</span>
                </div>
                
                <div class="hidden md:flex space-x-1">
                    <button onclick="renderProducts('all')" class="px-3 py-2 rounded text-sm font-medium hover:bg-gray-800 text-gray-300 transition">–í—Å–µ</button>
                    <button onclick="renderProducts('combat')" class="px-3 py-2 rounded text-sm font-medium hover:bg-gray-800 text-gray-300 transition">–ë–æ–µ–≤–æ–µ</button>
                    <button onclick="renderProducts('traumatic')" class="px-3 py-2 rounded text-sm font-medium hover:bg-gray-800 text-gray-300 transition">–¢—Ä–∞–≤–º–∞—Ç</button>
                    <button onclick="renderProducts('other')" class="px-3 py-2 rounded text-sm font-medium hover:bg-gray-800 text-gray-300 transition">–°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ</button>
                </div>

                <div class="flex items-center gap-4">
                    <div class="relative hidden sm:block">
                        <input type="text" id="search" placeholder="–ü–æ–∏—Å–∫..." class="bg-gray-800 text-sm border border-gray-700 rounded-lg pl-3 pr-8 py-1.5 focus:outline-none focus:border-blue-500 w-40 text-gray-300 transition" oninput="handleSearch(this.value)">
                    </div>
                    
                    <!-- –ö–æ—Ä–∑–∏–Ω–∞ -->
                    <button onclick="openCart()" class="relative p-2 text-gray-400 hover:text-white transition">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        <span id="cart-count" class="hidden absolute top-0 right-0 bg-red-600 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full cart-badge">0</span>
                    </button>
                </div>
            </div>
        </div>
        <div class="md:hidden flex gap-2 overflow-x-auto p-2 border-t border-gray-800 bg-gray-950 scrollbar-hide">
            <button onclick="renderProducts('combat')" class="whitespace-nowrap px-3 py-1 bg-gray-800 rounded-full text-xs border border-gray-700">üî• –ë–æ–µ–≤–æ–µ</button>
            <button onclick="renderProducts('traumatic')" class="whitespace-nowrap px-3 py-1 bg-gray-800 rounded-full text-xs border border-gray-700">üõ° –¢—Ä–∞–≤–º–∞—Ç</button>
            <button onclick="renderProducts('other')" class="whitespace-nowrap px-3 py-1 bg-gray-800 rounded-full text-xs border border-gray-700">üì¶ –°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ</button>
        </div>
    </nav>

    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="flex-grow max-w-7xl mx-auto px-4 py-8 w-full">
        <!-- –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ -->
        <div class="mb-10 text-center space-y-2">
            <div class="inline-flex items-center gap-2 bg-blue-900/30 border border-blue-800 text-blue-300 px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider mb-2">
                <span>üõ°Ô∏è</span> –ì–∞—Ä–∞–Ω—Ç–∏—è –ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏
            </div>
            <h1 class="text-3xl md:text-4xl font-bold text-white">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ê—Ä—Å–µ–Ω–∞–ª</h1>
            <p class="text-gray-400 text-sm md:text-base max-w-2xl mx-auto leading-relaxed">
                –í—Å–µ —Å–¥–µ–ª–∫–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —Å—Ç—Ä–æ–≥–æ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ. –ú—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –ø–æ–ª–Ω—É—é –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏. –ù–∞—à —Å–µ—Ä–≤–∏—Å –ø—Ä–æ–≤–µ—Ä–µ–Ω –≤—Ä–µ–º–µ–Ω–µ–º –∏ —Ç—ã—Å—è—á–∞–º–∏ —É—Å–ø–µ—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ –ø–æ –≤—Å–µ–º—É –°–ù–ì.
            </p>
        </div>

        <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
        <div id="empty-state" class="hidden flex flex-col items-center justify-center py-20 text-gray-500">
            <span class="text-4xl mb-2">üïµÔ∏è</span>
            <p>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
        </div>
    </main>

    <footer class="bg-gray-900 border-t border-gray-800 py-8 mt-auto">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-gray-500 text-sm mb-2">&copy; 2026 TacticalShop. Onion Routing Secured.</p>
            <div class="flex justify-center gap-4 text-xs text-gray-600">
                <a href="#" class="hover:text-gray-400">–ü—Ä–∞–≤–∏–ª–∞</a>
                <a href="#" class="hover:text-gray-400">PGP –ö–ª—é—á</a>
                <a href="https://t.me/+l4Mt8VCqCf42ZDU5" target="_blank" class="hover:text-blue-400">–û—Ç–∑—ã–≤—ã</a>
            </div>
        </div>
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¢–æ–≤–∞—Ä–∞ -->
    <div id="product-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-sm" onclick="closeProductModal()"></div>
        <div class="relative bg-gray-900 w-full max-w-2xl rounded-2xl shadow-2xl border border-gray-700 flex flex-col max-h-[90vh] overflow-hidden">
            <div class="flex justify-between items-center px-6 py-4 border-b border-gray-800 bg-gray-900/50">
                <h3 class="text-lg font-bold text-white">–û–±–∑–æ—Ä —Ç–æ–≤–∞—Ä–∞</h3>
                <button onclick="closeProductModal()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
            </div>
            <div class="overflow-y-auto p-6 custom-scrollbar">
                <div class="flex flex-col sm:flex-row gap-6 mb-8">
                    <div class="w-full sm:w-40 h-40 flex-shrink-0 bg-gray-800 rounded-xl border border-gray-700 flex items-center justify-center text-6xl shadow-inner">
                        <span id="pm-icon"></span>
                    </div>
                    <div class="flex-grow">
                        <div class="flex justify-between items-start mb-2">
                            <h2 id="pm-name" class="text-2xl font-bold text-white"></h2>
                            <span id="pm-badge" class="hidden px-2 py-1 bg-blue-900 text-blue-300 text-[10px] font-bold uppercase rounded tracking-wider"></span>
                        </div>
                        <div class="flex items-center gap-2 mb-3">
                            <div class="text-yellow-500 text-sm">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                            <span id="pm-rating" class="text-xs text-gray-400"></span>
                        </div>
                        <p id="pm-price" class="text-3xl font-bold text-blue-500 mb-4 font-mono"></p>
                        <p id="pm-desc" class="text-gray-400 text-sm leading-relaxed whitespace-pre-line"></p>
                    </div>
                </div>
                
                <div class="mb-8 border-t border-gray-800 pt-6">
                    <h4 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-3">–û—Ç–∑—ã–≤—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</h4>
                    <div id="pm-reviews" class="space-y-3"></div>
                </div>

                <button onclick="addToCartCurrent()" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-4 rounded-xl transition shadow-lg shadow-blue-900/20 flex items-center justify-center gap-2">
                    <span>üõí</span> –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ö–æ—Ä–∑–∏–Ω—ã/–ó–∞–∫–∞–∑–∞ -->
    <div id="cart-modal" class="modal fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-sm" onclick="closeCartModal()"></div>
        <div class="relative bg-gray-900 w-full max-w-lg rounded-2xl shadow-2xl border border-gray-700 flex flex-col max-h-[90vh] overflow-hidden">
            
            <!-- –®–∞–ø–∫–∞ -->
            <div class="flex justify-between items-center px-6 py-4 border-b border-gray-800 bg-gray-900/50">
                <h3 id="cart-title" class="text-lg font-bold text-white">–ö–æ—Ä–∑–∏–Ω–∞</h3>
                <button onclick="closeCartModal()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
            </div>

            <div class="overflow-y-auto p-6 custom-scrollbar flex-grow">
                
                <!-- 1. –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ -->
                <div id="view-cart-list">
                    <div id="cart-items" class="space-y-3 mb-6"></div>
                    <div id="cart-empty" class="text-center py-10 text-gray-500 hidden">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</div>
                    
                    <div id="cart-summary" class="border-t border-gray-800 pt-4">
                        <div class="flex justify-between items-center mb-6">
                            <span class="text-gray-400">–ò—Ç–æ–≥–æ:</span>
                            <span id="cart-total" class="text-2xl font-bold text-white font-mono">0 ‚ÇΩ</span>
                        </div>
                        <button onclick="toCheckout()" class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-3.5 rounded-xl transition shadow-lg shadow-green-900/20">
                            –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                        </button>
                    </div>
                </div>

                <!-- 2. –§–æ—Ä–º–∞ –¥–∞–Ω–Ω—ã—Ö -->
                <div id="view-checkout" class="hidden space-y-5">
                    <div class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white mb-2" onclick="toCartView()">
                        <span>‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–æ—Ä–∑–∏–Ω—É</span>
                    </div>

                    <div class="bg-blue-900/20 border border-blue-800/50 p-3 rounded-lg flex gap-3 items-start">
                        <span class="text-xl">üîí</span>
                        <p class="text-xs text-blue-200 leading-relaxed">–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —à–∏—Ñ—Ä—É—é—Ç—Å—è –∏ —É–¥–∞–ª—è—é—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏. Email –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ–∫–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ).</p>
                    </div>

                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-bold text-gray-500 uppercase mb-2">–°—Ç—Ä–∞–Ω–∞</label>
                                <select id="country" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-3 focus:border-blue-500 outline-none" onchange="updateCities()">
                                    <option value="ru">üá∑üá∫ –†–æ—Å—Å–∏—è</option>
                                    <option value="ua">üá∫üá¶ –£–∫—Ä–∞–∏–Ω–∞</option>
                                    <option value="kz">üá∞üáø –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω</option>
                                    <option value="by">üáßüáæ –ë–µ–ª–∞—Ä—É—Å—å</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-gray-500 uppercase mb-2">–ì–æ—Ä–æ–¥</label>
                                <select id="city" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-3 focus:border-blue-500 outline-none"></select>
                            </div>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Email (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                            <input type="email" id="email" placeholder="protonmail@example.com" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-3 focus:border-blue-500 outline-none placeholder-gray-600 transition">
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">–î–æ—Å—Ç–∞–≤–∫–∞</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="cursor-pointer">
                                    <input type="radio" name="delivery" value="courier" class="peer sr-only" checked>
                                    <div class="text-center py-3 bg-gray-800 border border-gray-700 rounded-lg peer-checked:border-blue-500 peer-checked:bg-blue-900/20 text-gray-300 peer-checked:text-blue-400 transition">
                                        <div class="font-bold text-sm">üèÉ –ö—É—Ä—å–µ—Ä</div>
                                    </div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="delivery" value="drop" class="peer sr-only">
                                    <div class="text-center py-3 bg-gray-800 border border-gray-700 rounded-lg peer-checked:border-blue-500 peer-checked:bg-blue-900/20 text-gray-300 peer-checked:text-blue-400 transition">
                                        <div class="font-bold text-sm">üìç –¢–∞–π–Ω–∏–∫</div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">–û–ø–ª–∞—Ç–∞</label>
                            <div class="space-y-2">
                                <label class="flex items-center justify-between p-3 bg-gray-800 border border-gray-700 rounded-lg cursor-pointer hover:border-gray-500 transition">
                                    <span class="flex items-center gap-3"><span class="text-lg">üíé</span> USDT (TRC20)</span>
                                    <input type="radio" name="payment" value="usdt" checked class="accent-blue-500 w-4 h-4">
                                </label>
                                <label class="flex items-center justify-between p-3 bg-gray-800 border border-gray-700 rounded-lg cursor-pointer hover:border-gray-500 transition">
                                    <span class="flex items-center gap-3"><span class="text-lg">‚Çø</span> Bitcoin</span>
                                    <input type="radio" name="payment" value="btc" class="accent-blue-500 w-4 h-4">
                                </label>
                                <label class="flex items-center justify-between p-3 bg-gray-800 border border-gray-700 rounded-lg cursor-pointer hover:border-gray-500 transition">
                                    <span class="flex items-center gap-3"><span class="text-lg">≈Å</span> Litecoin</span>
                                    <input type="radio" name="payment" value="ltc" class="accent-blue-500 w-4 h-4">
                                </label>
                            </div>
                        </div>
                    </div>
                    <button onclick="toInvoice()" class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-4 rounded-xl transition shadow-lg shadow-green-900/20 mt-4">
                        –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏ –æ–ø–ª–∞—Ç–∏—Ç—å
                    </button>
                </div>

                <!-- 3. –ò–Ω–≤–æ–π—Å -->
                <div id="view-invoice" class="hidden text-center py-4">
                    <div class="w-16 h-16 bg-blue-900/30 text-blue-400 rounded-full flex items-center justify-center text-3xl mx-auto mb-4 animate-pulse">üßæ</div>
                    <h3 class="text-xl font-bold text-white mb-1">–û–∂–∏–¥–∞–Ω–∏–µ –æ–ø–ª–∞—Ç—ã</h3>
                    <div id="timer" class="text-3xl font-mono text-red-500 font-bold mb-6 tracking-widest">15:00</div>
                    
                    <div class="bg-black/30 border border-gray-700 p-5 rounded-xl text-left mb-6">
                        <div class="flex justify-between mb-2 text-sm">
                            <span class="text-gray-400">–°—É–º–º–∞ (RUB):</span>
                            <span id="inv-rub" class="font-bold text-white"></span>
                        </div>
                        <div class="flex justify-between mb-4 text-sm">
                            <span class="text-gray-400">–ö –æ–ø–ª–∞—Ç–µ:</span>
                            <span id="inv-crypto" class="font-bold text-green-400 font-mono"></span>
                        </div>
                        <div class="pt-4 border-t border-gray-700">
                            <div class="flex justify-between items-end mb-2">
                                <span class="text-[10px] text-gray-500 font-bold uppercase tracking-wider">–ö–æ—à–µ–ª–µ–∫ <span id="inv-wallet-name"></span></span>
                                <span class="text-blue-400 text-xs cursor-pointer hover:text-white transition" onclick="copyWallet()">COPY</span>
                            </div>
                            <div class="bg-gray-800 p-3 rounded border border-gray-700 break-all font-mono text-xs text-gray-300 select-all cursor-pointer hover:border-blue-500 transition" id="inv-addr" onclick="copyWallet()"></div>
                        </div>
                    </div>
                    
                    <button onclick="showToast('–ü–ª–∞—Ç–µ–∂ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è... –û–∂–∏–¥–∞–π—Ç–µ.', 'success'); closeCartModal(); cart=[]; updateCartUI();" class="w-full bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 rounded-lg border border-gray-700 transition">–Ø –æ–ø–ª–∞—Ç–∏–ª</button>
                </div>

            </div>
        </div>
    </div>

    <!-- –¢–æ—Å—Ç—ã -->
    <div id="toast-container" class="toast-container"></div>

    <script>
        const PRODUCTS = [
            { id: "c1", cat: "combat", name: "AK-74M", price: 45000, icon: "‚öîÔ∏è", badge: "HIT", rating: "4.9", desc: "–ë–æ–µ–≤–æ–π –∞–≤—Ç–æ–º–∞—Ç –ö–∞–ª–∞—à–Ω–∏–∫–æ–≤–∞ (5.45). –°–ø–∏—Å–∞–Ω–Ω–æ–µ –±–æ–µ–≤–æ–µ, –ø–æ–ª–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞.", reviews: [{u:"Alex",t:"–í—Å–µ —á–µ—Ç–∫–æ.",r:5}, {u:"Ivan",t:"–°–º–∞–∑–∫–∞ –∑–∞–≤–æ–¥—Å–∫–∞—è.",r:5}] },
            { id: "c2", cat: "combat", name: "–ê–ö–°-74–£", price: 52000, icon: "üå™", badge: null, rating: "5.0", desc: "–£–∫–æ—Ä–æ—á–µ–Ω–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç (–ö—Å—é—Ö–∞). –ò–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–µ—Ä–µ–≤–∞.", reviews: [{u:"Dmitry",t:"–í –º–∞—à–∏–Ω—É —Å–∞–º–æ–µ —Ç–æ.",r:5}] },
            { id: "c3", cat: "combat", name: "–ê–ö–ú", price: 48000, icon: "üî•", badge: "RARE", rating: "4.8", desc: "–ö–ª–∞—Å—Å–∏–∫–∞ 1960-—Ö (7.62). –ü—Ä–æ–±–∏–≤–∞–µ—Ç –∫–∏—Ä–ø–∏—á–Ω—É—é –∫–ª–∞–¥–∫—É.", reviews: [{u:"Oleg",t:"–ò—Å—Ç–æ—Ä–∏—è –≤ —Ä—É–∫–∞—Ö.",r:5}] },
            { id: "c4", cat: "combat", name: "–°–í–î", price: 85000, icon: "üéØ", badge: null, rating: "5.0", desc: "–°–Ω–∞–π–ø–µ—Ä—Å–∫–∞—è –≤–∏–Ω—Ç–æ–≤–∫–∞ –î—Ä–∞–≥—É–Ω–æ–≤–∞. –ü—Ä–∏—Ü–µ–ª –ü–°–û-1 –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ.", reviews: [{u:"Sniper",t:"–û–ø—Ç–∏–∫–∞ —á–∏—Å—Ç–∞—è.",r:5}] },
            { id: "c5", cat: "combat", name: "–ü–ú", price: 25000, icon: "‚≠ê", badge: "TOP", rating: "4.7", desc: "–ü–∏—Å—Ç–æ–ª–µ—Ç –ú–∞–∫–∞—Ä–æ–≤–∞ (–°–°–°–†). –ù–∞—Ä–µ–∑–Ω–æ–π —Å—Ç–≤–æ–ª, –≤–æ—Ä–æ–Ω–µ–Ω–∏–µ.", reviews: [{u:"Max",t:"–ö–ª–∞—Å—Å–∏–∫–∞.",r:4}] },
            { id: "c6", cat: "combat", name: "–¢–¢-33", price: 32000, icon: "üî´", badge: null, rating: "4.9", desc: "–¢—É–ª—å—Å–∫–∏–π –¢–æ–∫–∞—Ä–µ–≤ (–í–æ–µ–Ω–Ω—ã–π). –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–±–∏–≤–∞–µ–º–æ—Å—Ç—å.", reviews: [{u:"Patriot",t:"–ú–æ—â—å.",r:5}] },
            { id: "c7", cat: "combat", name: "–ê–ü–°", price: 110000, icon: "üß®", badge: "NEW", rating: "5.0", desc: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ü–∏—Å—Ç–æ–ª–µ—Ç –°—Ç–µ—á–∫–∏–Ω–∞. –†–µ–∂–∏–º –∞–≤—Ç–æ-–æ–≥–Ω—è.", reviews: [{u:"Coll",t:"–†–µ–¥–∫–æ—Å—Ç—å.",r:5}] },
            { id: "t1", cat: "traumatic", name: "–û—Å–∞ –ü–ë-4", price: 14500, icon: "üõ°", badge: null, rating: "4.6", desc: "–ë–µ—Å—Å—Ç–≤–æ–ª—å–Ω—ã–π —Ç—Ä–∞–≤–º–∞—Ç (18.5—Ö55). –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç.", reviews: [{u:"Guard",t:"–í–∞–ª–∏—Ç —Å –Ω–æ–≥.",r:5}] },
            { id: "t2", cat: "traumatic", name: "–ü–ú-–¢", price: 65000, icon: "üí•", badge: "HIT", rating: "4.8", desc: "–¢—Ä–∞–≤–º–∞—Ç –∏–∑ –±–æ–µ–≤–æ–≥–æ –ü–ú. –ú–∏–Ω–∏–º—É–º –ø–µ—Ä–µ–¥–µ–ª–æ–∫.", reviews: [{u:"Kirill",t:"–ö–∞–∫ –±–æ–µ–≤–æ–π.",r:5}] },
            { id: "t3", cat: "traumatic", name: "Grand Power", price: 42000, icon: "ü¶æ", badge: "TOP", rating: "4.9", desc: "–°–ª–æ–≤–∞–∫–∏—è (10—Ö28). –≠—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π –∏ –º–æ—â–Ω—ã–π.", reviews: [{u:"Sport",t:"–¢–æ—á–Ω—ã–π.",r:5}] },
            { id: "t4", cat: "traumatic", name: "–¢–¢-–¢", price: 28000, icon: "üß±", badge: null, rating: "4.5", desc: "–¢—Ä–∞–≤–º–∞—Ç –∏–∑ –¢–¢. –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Ö–∞—Ä–∏–∑–º–∞.", reviews: [{u:"Hist",t:"–î–ª—è –¥—É—à–∏.",r:4}] },
            { id: "o1", cat: "other", name: "–¶–∏–Ω–∫ 5.45", price: 45000, icon: "üì¶", badge: "BULK", rating: "5.0", desc: "1080 —à—Ç. –ê—Ä–º–µ–π—Å–∫–∏–π. –°—Ç–∞–ª—å–Ω–æ–π —Å–µ—Ä–¥–µ—á–Ω–∏–∫.", reviews: [] },
            { id: "o2", cat: "other", name: "7.62—Ö39 (50—à—Ç)", price: 3800, icon: "üíä", badge: null, rating: "4.8", desc: "–î–ª—è –ê–ö–ú. –û–±–æ–ª–æ—á–µ—á–Ω—ã–µ.", reviews: [] },
            { id: "o3", cat: "other", name: "9x18 –ü–ú (50—à—Ç)", price: 3200, icon: "üç¨", badge: null, rating: "4.9", desc: "–®—Ç–∞—Ç–Ω—ã–µ. –î–ª—è –ü–ú/–ê–ü–°.", reviews: [] },
            { id: "o4", cat: "other", name: "9x19 Luger", price: 3500, icon: "üîò", badge: null, rating: "4.8", desc: "50 —à—Ç. –°—Ç–∞–Ω–¥–∞—Ä—Ç –ù–ê–¢–û.", reviews: [] },
            { id: "o5", cat: "other", name: "–ö–æ–±—É—Ä–∞ Kydex", price: 4500, icon: "üëñ", badge: "NEW", rating: "4.7", desc: "–°–∫—Ä—ã—Ç–æ–µ –Ω–æ—à–µ–Ω–∏–µ. –§–æ—Ä–º—É–µ—Ç—Å—è –ø–æ–¥ –º–æ–¥–µ–ª—å.", reviews: [] },
            { id: "o6", cat: "other", name: "–ö–µ–π—Å (Hard)", price: 12000, icon: "üß≥", badge: null, rating: "5.0", desc: "–£–¥–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π IP67. –° –ø–æ—Ä–æ–ª–æ–Ω–æ–º.", reviews: [] }
        ];

        const LOCATIONS = { ru: ["–ú–æ—Å–∫–≤–∞", "–°–ü–ë", "–ï–ö–ë", "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫"], ua: ["–ö–∏–µ–≤", "–•–∞—Ä—å–∫–æ–≤", "–û–¥–µ—Å—Å–∞", "–õ—å–≤–æ–≤"], kz: ["–ê–ª–º–∞—Ç—ã", "–ê—Å—Ç–∞–Ω–∞", "–®—ã–º–∫–µ–Ω—Ç"], by: ["–ú–∏–Ω—Å–∫", "–ì–æ–º–µ–ª—å", "–ë—Ä–µ—Å—Ç"] };
        const WALLETS = { usdt: { addr: "TRxXRhED1G12UEF74riYfkxxws8fKEC4Ca", name: "USDT TRC20", rateId: "tether" }, btc: { addr: "bc1qfutymnq0m7ekah54gxjwq00rdstvg6k0duvdl5", name: "Bitcoin", rateId: "bitcoin" }, ltc: { addr: "ltc1qhnqel0z5qfdl8efyztuu6q2wd6puyfu2u56995", name: "Litecoin", rateId: "litecoin" } };

        let cart = [];
        let rates = { tether: 98, bitcoin: 9500000, litecoin: 9500 };
        let currentItem = null;
        let timerInt = null;

        function renderProducts(filter) {
            const grid = document.getElementById('products-grid');
            grid.innerHTML = '';
            let count = 0;
            const searchQ = document.getElementById('search').value.toLowerCase();

            PRODUCTS.forEach(p => {
                if (filter !== 'all' && p.cat !== filter) return;
                if (searchQ && !p.name.toLowerCase().includes(searchQ)) return;

                const card = document.createElement('div');
                card.className = "product-card bg-gray-800 rounded-xl overflow-hidden border border-gray-700 relative cursor-pointer group";
                card.onclick = (e) => { if(!e.target.closest('button')) openProduct(p.id); };

                let badgeHTML = p.badge ? `<div class="absolute top-2 right-2 bg-blue-600 text-white text-[10px] font-bold px-2 py-1 rounded z-10 shadow">${p.badge}</div>` : '';

                card.innerHTML = `
                    ${badgeHTML}
                    <div class="h-40 w-full icon-box flex items-center justify-center text-7xl group-hover:scale-110 transition duration-300">${p.icon}</div>
                    <div class="p-4">
                        <div class="flex justify-between items-start mb-1">
                            <h3 class="font-bold text-white text-lg leading-tight">${p.name}</h3>
                        </div>
                        <div class="flex items-center gap-1 mb-3">
                            <span class="text-yellow-500 text-xs">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                            <span class="text-xs text-gray-500">${p.rating}</span>
                        </div>
                        <p class="text-xs text-gray-400 mb-4 line-clamp-2 h-8">${p.desc}</p>
                        <div class="flex justify-between items-center pt-3 border-t border-gray-700">
                            <span class="text-blue-400 font-bold font-mono text-lg">${p.price.toLocaleString()} ‚ÇΩ</span>
                            <button onclick="addToCart('${p.id}'); event.stopPropagation()" class="bg-gray-700 hover:bg-blue-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold transition flex items-center gap-1">
                                + –í –∫–æ—Ä–∑–∏–Ω—É
                            </button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
                count++;
            });
            document.getElementById('empty-state').style.display = count === 0 ? 'flex' : 'none';
        }

        function handleSearch() { renderProducts('all'); }

        function openProduct(id) {
            currentItem = PRODUCTS.find(p => p.id === id);
            if (!currentItem) return;
            document.getElementById('pm-icon').textContent = currentItem.icon;
            document.getElementById('pm-name').textContent = currentItem.name;
            document.getElementById('pm-price').textContent = currentItem.price.toLocaleString() + ' ‚ÇΩ';
            document.getElementById('pm-desc').textContent = currentItem.desc;
            document.getElementById('pm-rating').textContent = currentItem.rating;
            
            const rDiv = document.getElementById('pm-reviews');
            rDiv.innerHTML = currentItem.reviews.length ? currentItem.reviews.map(r => `<div class="bg-gray-800 p-3 rounded-lg border border-gray-700 text-sm"><div class="flex justify-between mb-1"><span class="font-bold text-gray-300">${r.u}</span><span class="text-yellow-500">‚òÖ ${r.r}</span></div><p class="text-gray-400 italic">"${r.t}"</p></div>`).join('') : '<p class="text-gray-500 italic">–ù–µ—Ç –æ—Ç–∑—ã–≤–æ–≤</p>';
            
            toggleModal('product-modal', true);
        }

        function addToCartCurrent() { if(currentItem) addToCart(currentItem.id); closeProductModal(); }

        function addToCart(id) {
            const prod = PRODUCTS.find(p => p.id === id);
            cart.push(prod);
            updateCartUI();
            showToast(`–î–æ–±–∞–≤–ª–µ–Ω–æ: ${prod.name}`, 'success');
        }

        function updateCartUI() {
            const badge = document.getElementById('cart-count');
            badge.textContent = cart.length;
            badge.style.display = cart.length > 0 ? 'block' : 'none';
            // Animation reset
            badge.classList.remove('cart-badge');
            void badge.offsetWidth; 
            badge.classList.add('cart-badge');
        }

        function openCart() {
            const list = document.getElementById('cart-items');
            list.innerHTML = '';
            let total = 0;

            if (cart.length === 0) {
                document.getElementById('cart-empty').style.display = 'block';
                document.getElementById('cart-summary').style.display = 'none';
            } else {
                document.getElementById('cart-empty').style.display = 'none';
                document.getElementById('cart-summary').style.display = 'block';
                cart.forEach((item, index) => {
                    total += item.price;
                    const el = document.createElement('div');
                    el.className = "flex justify-between items-center bg-gray-800 p-3 rounded-lg border border-gray-700";
                    el.innerHTML = `
                        <div class="flex items-center gap-3">
                            <span class="text-2xl">${item.icon}</span>
                            <div>
                                <p class="text-sm font-bold text-white">${item.name}</p>
                                <p class="text-xs text-gray-400">${item.price.toLocaleString()} ‚ÇΩ</p>
                            </div>
                        </div>
                        <button onclick="removeFromCart(${index})" class="text-red-500 hover:text-red-400 text-lg">√ó</button>
                    `;
                    list.appendChild(el);
                });
            }
            document.getElementById('cart-total').textContent = total.toLocaleString() + ' ‚ÇΩ';
            toCartView();
            toggleModal('cart-modal', true);
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartUI();
            openCart();
        }

        // Modal Logic
        function toggleModal(id, show) {
            const el = document.getElementById(id);
            if(show) { el.classList.add('active'); document.body.classList.add('modal-open'); }
            else { el.classList.remove('active'); document.body.classList.remove('modal-open'); }
        }
        function closeProductModal() { toggleModal('product-modal', false); }
        function closeCartModal() { toggleModal('cart-modal', false); clearInterval(timerInt); }

        // Checkout Logic
        function toCartView() {
            document.getElementById('view-cart-list').classList.remove('hidden');
            document.getElementById('view-checkout').classList.add('hidden');
            document.getElementById('view-invoice').classList.add('hidden');
            document.getElementById('cart-title').textContent = "–ö–æ—Ä–∑–∏–Ω–∞";
        }
        function toCheckout() {
            document.getElementById('view-cart-list').classList.add('hidden');
            document.getElementById('view-checkout').classList.remove('hidden');
            document.getElementById('cart-title').textContent = "–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞";
            updateCities();
        }
        function toInvoice() {
            const payMethod = document.querySelector('input[name="payment"]:checked').value;
            const total = cart.reduce((sum, i) => sum + i.price, 0);
            const wallet = WALLETS[payMethod];
            const amount = (total / rates[wallet.rateId]).toFixed(payMethod === 'btc' ? 6 : 4);

            document.getElementById('inv-rub').textContent = total.toLocaleString() + ' RUB';
            document.getElementById('inv-crypto').textContent = `${amount} ${payMethod.toUpperCase()}`;
            document.getElementById('inv-wallet-name').textContent = wallet.name;
            document.getElementById('inv-addr').textContent = wallet.addr;

            document.getElementById('view-checkout').classList.add('hidden');
            document.getElementById('view-invoice').classList.remove('hidden');
            startTimer();
        }

        function updateCities() {
            const c = document.getElementById('country').value;
            const s = document.getElementById('city');
            s.innerHTML = '';
            LOCATIONS[c].forEach(city => {
                const opt = document.createElement('option');
                opt.value = city;
                opt.textContent = city;
                s.appendChild(opt);
            });
        }

        function startTimer() {
            clearInterval(timerInt);
            let t = 900; 
            const el = document.getElementById('timer');
            timerInt = setInterval(() => {
                const m = Math.floor(t / 60).toString().padStart(2, '0');
                const s = (t % 60).toString().padStart(2, '0');
                el.textContent = `${m}:${s}`;
                if (--t < 0) clearInterval(timerInt);
            }, 1000);
        }

        function copyWallet() {
            navigator.clipboard.writeText(document.getElementById('inv-addr').textContent);
            showToast('–ê–¥—Ä–µ—Å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω', 'success');
        }

        function showToast(msg, type) {
            const box = document.getElementById('toast-container');
            const el = document.createElement('div');
            const color = type === 'success' ? 'border-green-500 text-green-400' : 'border-blue-500 text-blue-400';
            el.className = `toast bg-gray-800 border-l-4 ${color} text-white px-4 py-3 rounded shadow-lg min-w-[200px] text-sm font-medium`;
            el.textContent = msg;
            box.appendChild(el);
            setTimeout(() => { el.style.opacity = '0'; setTimeout(() => el.remove(), 300); }, 3000);
        }

        renderProducts('all');
    </script>
</body>
</html>
